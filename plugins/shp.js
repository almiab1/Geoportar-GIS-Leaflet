!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.shp=e()}}((function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,(function(e){var n=t[o][1][e];return s(n||e)}),f,f.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){var promise=_dereq_("lie");function binaryAjax(url){return promise((function(resolve,reject){var type=url.slice(-3),ajax=new XMLHttpRequest;ajax.open("GET",url,!0),"prj"!==type&&(ajax.responseType="arraybuffer"),ajax.addEventListener("load",(function(){if(ajax.status>399)return"prj"===type?resolve(!1):reject(new Error(ajax.status));resolve(ajax.response)}),!1),ajax.send()}))}module.exports=binaryAjax},{lie:31}],2:[function(_dereq_,module,exports){var proj4=_dereq_("proj4"),unzip=_dereq_("./unzip"),binaryAjax=_dereq_("./binaryajax"),all=_dereq_("lie-all"),parseShp=_dereq_("./parseShp"),parseDbf=_dereq_("parsedbf"),promise=_dereq_("lie");function shp(base,whiteList){return shp.getShapefile(base,whiteList)}function getZip(base,whiteList){return binaryAjax(base).then((function(a){return shp.parseZip(a,whiteList)}))}shp.combine=function(arr){for(var out={type:"FeatureCollection",features:[]},i=0,len=arr[0].length;i<len;)out.features.push({type:"Feature",geometry:arr[0][i],properties:arr[1][i]}),i++;return out},shp.parseZip=function(buffer,whiteList){var key,zip=unzip(buffer),names=[];for(key in whiteList=whiteList||[],zip)"shp"===key.slice(-3).toLowerCase()?names.push(key.slice(0,-4)):"dbf"===key.slice(-3).toLowerCase()?zip[key]=parseDbf(zip[key]):"prj"===key.slice(-3).toLowerCase()?zip[key]=proj4(zip[key]):("json"===key.slice(-4).toLowerCase()||whiteList.indexOf(key.split(".").pop())>-1)&&names.push(key);if(!names.length)throw new Error("no layers founds");var geojson=names.map((function(name){var parsed;return"json"===name.slice(-4).toLowerCase()?(parsed=JSON.parse(zip[name])).fileName=name.slice(0,name.lastIndexOf(".")):whiteList.indexOf(name.slice(name.lastIndexOf(".")+1))>-1?(parsed=zip[name]).fileName=name:(parsed=shp.combine([parseShp(zip[name+".shp"],zip[name+".prj"]),zip[name+".dbf"]])).fileName=name,parsed}));return 1===geojson.length?geojson[0]:geojson},shp.getShapefile=function(base,whiteList){return"string"==typeof base?".zip"===base.slice(-4)?getZip(base,whiteList):all([all([binaryAjax(base+".shp"),binaryAjax(base+".prj")]).then((function(args){return parseShp(args[0],!!args[1]&&proj4(args[1]))})),binaryAjax(base+".dbf").then(parseDbf)]).then(shp.combine):promise((function(resolve){resolve(shp.parseZip(base))}))},module.exports=shp},{"./binaryajax":1,"./parseShp":3,"./unzip":4,lie:31,"lie-all":25,parsedbf:41,proj4:76}],3:[function(_dereq_,module,exports){function isClockWise(array){for(var sum=0,i=1,len=array.length,prev,cur;i<len;)prev=cur||array[0],sum+=((cur=array[i])[0]-prev[0])*(cur[1]+prev[1]),i++;return sum>0}function polyReduce(a,b){return isClockWise(b)||!a.length?a.push([b]):a[a.length-1].push(b),a}ParseShp.prototype.parsePoint=function(data){return{type:"Point",coordinates:this.parseCoord(data,0)}},ParseShp.prototype.parseZPoint=function(data){var pointXY=this.parsePoint(data);return pointXY.coordinates.push(this.parseCoord(data,16)),pointXY},ParseShp.prototype.parsePointArray=function(data,offset,num){for(var out=[],done=0;done<num;)out.push(this.parseCoord(data,offset)),offset+=16,done++;return out},ParseShp.prototype.parseZPointArray=function(data,zOffset,num,coordinates){for(var i=0;i<num;)coordinates[i].push(data.getFloat64(zOffset,!0)),i++,zOffset+=8;return coordinates},ParseShp.prototype.parseArrayGroup=function(data,offset,partOffset,num,tot){for(var out=[],done=0,curNum,nextNum=0,pointNumber;done<num;)partOffset+=4,curNum=nextNum,(pointNumber=(nextNum=++done===num?tot:data.getInt32(partOffset,!0))-curNum)&&(out.push(this.parsePointArray(data,offset,pointNumber)),offset+=pointNumber<<4);return out},ParseShp.prototype.parseZArrayGroup=function(data,zOffset,num,coordinates){for(var i=0;i<num;)coordinates[i]=this.parseZPointArray(data,zOffset,coordinates[i].length,coordinates[i]),zOffset+=coordinates[i].length<<3,i++;return coordinates},ParseShp.prototype.parseMultiPoint=function(data){var out={};out.bbox=[data.getFloat64(0,!0),data.getFloat64(8,!0),data.getFloat64(16,!0),data.getFloat64(24,!0)];var num=data.getInt32(32,!0),offset=36;return 1===num?(out.type="Point",out.coordinates=this.parseCoord(data,36)):(out.type="MultiPoint",out.coordinates=this.parsePointArray(data,36,num)),out},ParseShp.prototype.parseZMultiPoint=function(data){var geoJson=this.parseMultiPoint(data),num;if("Point"===geoJson.type)return geoJson.coordinates.push(data.getFloat64(72,!0)),geoJson;var zOffset=56+((num=geoJson.coordinates.length)<<4);return geoJson.coordinates=this.parseZPointArray(data,zOffset,num,geoJson.coordinates),geoJson},ParseShp.prototype.parsePolyline=function(data){var out={};out.bbox=[data.getFloat64(0,!0),data.getFloat64(8,!0),data.getFloat64(16,!0),data.getFloat64(24,!0)];var numParts=data.getInt32(32,!0),num=data.getInt32(36,!0),offset,partOffset;return 1===numParts?(out.type="LineString",offset=44,out.coordinates=this.parsePointArray(data,offset,num)):(out.type="MultiLineString",offset=40+(numParts<<2),partOffset=40,out.coordinates=this.parseArrayGroup(data,offset,40,numParts,num)),out},ParseShp.prototype.parseZPolyline=function(data){var geoJson=this.parsePolyline(data),num=geoJson.coordinates.length,zOffset=60+(num<<4);return"LineString"===geoJson.type?(geoJson.coordinates=this.parseZPointArray(data,zOffset,num,geoJson.coordinates),geoJson):(geoJson.coordinates=this.parseZArrayGroup(data,zOffset,num,geoJson.coordinates),geoJson)},ParseShp.prototype.polyFuncs=function(out){return"LineString"===out.type?(out.type="Polygon",out.coordinates=[out.coordinates],out):(out.coordinates=out.coordinates.reduce(polyReduce,[]),1===out.coordinates.length?(out.type="Polygon",out.coordinates=out.coordinates[0],out):(out.type="MultiPolygon",out))},ParseShp.prototype.parsePolygon=function(data){return this.polyFuncs(this.parsePolyline(data))},ParseShp.prototype.parseZPolygon=function(data){return this.polyFuncs(this.parseZPolyline(data))};var shpFuncObj={1:"parsePoint",3:"parsePolyline",5:"parsePolygon",8:"parseMultiPoint",11:"parseZPoint",13:"parseZPolyline",15:"parseZPolygon",18:"parseZMultiPoint"};function makeParseCoord(trans){return trans?function(data,offset){return trans.inverse([data.getFloat64(offset,!0),data.getFloat64(offset+8,!0)])}:function(data,offset){return[data.getFloat64(offset,!0),data.getFloat64(offset+8,!0)]}}function ParseShp(buffer,trans){if(!(this instanceof ParseShp))return new ParseShp(buffer,trans);this.buffer=buffer,this.shpFuncs(trans),this.rows=this.getRows()}ParseShp.prototype.shpFuncs=function(tran){var num=this.getShpCode();if(num>20&&(num-=20),!(num in shpFuncObj))throw new Error("I don't know that shp type");this.parseFunc=this[shpFuncObj[num]],this.parseCoord=makeParseCoord(tran)},ParseShp.prototype.getShpCode=function(){return this.parseHeader().shpCode},ParseShp.prototype.parseHeader=function(){var view=new DataView(this.buffer,0,100);return{length:view.getInt32(24,!1),version:view.getInt32(28,!0),shpCode:view.getInt32(32,!0),bbox:[view.getFloat64(36,!0),view.getFloat64(44,!0),view.getFloat64(52,!0),view.getFloat64(52,!0)]}},ParseShp.prototype.getRows=function(){for(var offset=100,len=this.buffer.byteLength,out=[],current;offset<len;)current=this.getRow(offset),offset+=8,offset+=current.len,current.type&&out.push(this.parseFunc(current.data));return out},ParseShp.prototype.getRow=function(offset){var view=new DataView(this.buffer,offset,12),len=view.getInt32(4,!1)<<1,data=new DataView(this.buffer,offset+12,len-4);return{id:view.getInt32(0,!1),len:len,data:data,type:view.getInt32(8,!0)}},module.exports=function(buffer,trans){return ParseShp(buffer,trans).rows}},{}],4:[function(_dereq_,module,exports){var JSZip=_dereq_("jszip");module.exports=function(buffer){var zip,files=new JSZip(buffer).file(/.+/),out={};return files.forEach((function(a){"shp"===a.name.slice(-3).toLowerCase()||"dbf"===a.name.slice(-3).toLowerCase()?(out[a.name]=a.asText(),out[a.name]=a.asArrayBuffer()):out[a.name]=a.asText()})),out}},{jszip:13}],5:[function(_dereq_,module,exports){},{}],6:[function(_dereq_,module,exports){var process=module.exports={};process.nextTick=function(){var canSetImmediate="undefined"!=typeof window&&window.setImmediate,canPost="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(canSetImmediate)return function(f){return window.setImmediate(f)};if(canPost){var queue=[];return window.addEventListener("message",(function(ev){var source=ev.source,fn;source!==window&&null!==source||"process-tick"!==ev.data||(ev.stopPropagation(),queue.length>0&&queue.shift()())}),!0),function nextTick(fn){queue.push(fn),window.postMessage("process-tick","*")}}return function nextTick(fn){setTimeout(fn,0)}}(),process.title="browser",process.browser=!0,process.env={},process.argv=[],process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")}},{}],7:[function(_dereq_,module,exports){"use strict";var _keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";exports.encode=function(input,utf8){for(var output="",chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0;i<input.length;)enc1=(chr1=input.charCodeAt(i++))>>2,enc2=(3&chr1)<<4|(chr2=input.charCodeAt(i++))>>4,enc3=(15&chr2)<<2|(chr3=input.charCodeAt(i++))>>6,enc4=63&chr3,isNaN(chr2)?enc3=enc4=64:isNaN(chr3)&&(enc4=64),output=output+_keyStr.charAt(enc1)+_keyStr.charAt(enc2)+_keyStr.charAt(enc3)+_keyStr.charAt(enc4);return output},exports.decode=function(input,utf8){var output="",chr1,chr2,chr3,enc1,enc2,enc3,enc4,i=0;for(input=input.replace(/[^A-Za-z0-9\+\/\=]/g,"");i<input.length;)chr1=(enc1=_keyStr.indexOf(input.charAt(i++)))<<2|(enc2=_keyStr.indexOf(input.charAt(i++)))>>4,chr2=(15&enc2)<<4|(enc3=_keyStr.indexOf(input.charAt(i++)))>>2,chr3=(3&enc3)<<6|(enc4=_keyStr.indexOf(input.charAt(i++))),output+=String.fromCharCode(chr1),64!=enc3&&(output+=String.fromCharCode(chr2)),64!=enc4&&(output+=String.fromCharCode(chr3));return output}},{}],8:[function(_dereq_,module,exports){"use strict";function CompressedObject(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}CompressedObject.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},module.exports=CompressedObject},{}],9:[function(_dereq_,module,exports){"use strict";exports.STORE={magic:"\0\0",compress:function(content){return content},uncompress:function(content){return content},compressInputType:null,uncompressInputType:null},exports.DEFLATE=_dereq_("./flate")},{"./flate":12}],10:[function(_dereq_,module,exports){"use strict";var utils=_dereq_("./utils");function DataReader(data){this.data=null,this.length=0,this.index=0}DataReader.prototype={checkOffset:function(offset){this.checkIndex(this.index+offset)},checkIndex:function(newIndex){if(this.length<newIndex||newIndex<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+newIndex+"). Corrupted zip ?")},setIndex:function(newIndex){this.checkIndex(newIndex),this.index=newIndex},skip:function(n){this.setIndex(this.index+n)},byteAt:function(i){},readInt:function(size){var result=0,i;for(this.checkOffset(size),i=this.index+size-1;i>=this.index;i--)result=(result<<8)+this.byteAt(i);return this.index+=size,result},readString:function(size){return utils.transformTo("string",this.readData(size))},readData:function(size){},lastIndexOfSignature:function(sig){},readDate:function(){var dostime=this.readInt(4);return new Date(1980+(dostime>>25&127),(dostime>>21&15)-1,dostime>>16&31,dostime>>11&31,dostime>>5&63,(31&dostime)<<1)}},module.exports=DataReader},{"./utils":20}],11:[function(_dereq_,module,exports){"use strict";exports.base64=!1,exports.binary=!1,exports.dir=!1,exports.date=null,exports.compression=null},{}],12:[function(_dereq_,module,exports){"use strict";var USE_TYPEDARRAY="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,ZlibDeflate=_dereq_("zlibjs/bin/rawdeflate.min").Zlib,ZlibInflate=_dereq_("zlibjs/bin/rawinflate.min").Zlib;exports.uncompressInputType=USE_TYPEDARRAY?"uint8array":"array",exports.compressInputType=USE_TYPEDARRAY?"uint8array":"array",exports.magic="\b\0",exports.compress=function(input){var deflate;return new ZlibDeflate.RawDeflate(input).compress()},exports.uncompress=function(input){var inflate;return new ZlibInflate.RawInflate(input).decompress()}},{"zlibjs/bin/rawdeflate.min":23,"zlibjs/bin/rawinflate.min":24}],13:[function(_dereq_,module,exports){"use strict";function JSZip(data,options){this.files={},this.root="",data&&this.load(data,options),this.clone=function(){var newObj=new JSZip;for(var i in this)"function"!=typeof this[i]&&(newObj[i]=this[i]);return newObj}}JSZip.prototype=_dereq_("./object"),JSZip.prototype.load=_dereq_("./load"),JSZip.support=_dereq_("./support"),JSZip.utils=_dereq_("./utils"),JSZip.base64=_dereq_("./base64"),JSZip.compressions=_dereq_("./compressions"),module.exports=JSZip},{"./base64":7,"./compressions":9,"./load":14,"./object":15,"./support":18,"./utils":20}],14:[function(_dereq_,module,exports){"use strict";var base64=_dereq_("./base64"),ZipEntries=_dereq_("./zipEntries");module.exports=function(data,options){var files,zipEntries,i,input;for((options=options||{}).base64&&(data=base64.decode(data)),files=(zipEntries=new ZipEntries(data,options)).files,i=0;i<files.length;i++)input=files[i],this.file(input.fileName,input.decompressed,{binary:!0,optimizedBinaryString:!0,date:input.date,dir:input.dir});return this}},{"./base64":7,"./zipEntries":21}],15:[function(_dereq_,module,exports){"use strict";var support=_dereq_("./support"),utils=_dereq_("./utils"),signature=_dereq_("./signature"),defaults=_dereq_("./defaults"),base64=_dereq_("./base64"),compressions=_dereq_("./compressions"),CompressedObject=_dereq_("./compressedObject"),nodeBuffer=_dereq_("./nodeBuffer"),textEncoder,textDecoder;support.uint8array&&"function"==typeof TextEncoder&&"function"==typeof TextDecoder&&(textEncoder=new TextEncoder("utf-8"),textDecoder=new TextDecoder("utf-8"));var getRawData=function(file){if(file._data instanceof CompressedObject&&(file._data=file._data.getContent(),file.options.binary=!0,file.options.base64=!1,"uint8array"===utils.getTypeOf(file._data))){var copy=file._data;file._data=new Uint8Array(copy.length),0!==copy.length&&file._data.set(copy,0)}return file._data},getBinaryData=function(file){var result=getRawData(file),type;if("string"===utils.getTypeOf(result)){if(!file.options.binary){if(textEncoder)return textEncoder.encode(result);if(support.nodebuffer)return nodeBuffer(result,"utf-8")}return file.asBinary()}return result},dataToString=function(asUTF8){var result=getRawData(this);return null==result?"":(this.options.base64&&(result=base64.decode(result)),result=asUTF8&&this.options.binary?out.utf8decode(result):utils.transformTo("string",result),asUTF8||this.options.binary||(result=out.utf8encode(result)),result)},ZipObject=function(name,data,options){this.name=name,this._data=data,this.options=options};ZipObject.prototype={asText:function(){return dataToString.call(this,!0)},asBinary:function(){return dataToString.call(this,!1)},asNodeBuffer:function(){var result=getBinaryData(this);return utils.transformTo("nodebuffer",result)},asUint8Array:function(){var result=getBinaryData(this);return utils.transformTo("uint8array",result)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var decToHex=function(dec,bytes){var hex="",i;for(i=0;i<bytes;i++)hex+=String.fromCharCode(255&dec),dec>>>=8;return hex},extend=function(){var result={},i,attr;for(i=0;i<arguments.length;i++)for(attr in arguments[i])arguments[i].hasOwnProperty(attr)&&void 0===result[attr]&&(result[attr]=arguments[i][attr]);return result},prepareFileAttrs=function(o){return!0!==(o=o||{}).base64||null!==o.binary&&void 0!==o.binary||(o.binary=!0),(o=extend(o,defaults)).date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),o},fileAdd=function(name,data,o){var parent=parentFolder(name),dataType=utils.getTypeOf(data);if(parent&&folderAdd.call(this,parent),(o=prepareFileAttrs(o)).dir||null==data)o.base64=!1,o.binary=!1,data=null;else if("string"===dataType)o.binary&&!o.base64&&!0!==o.optimizedBinaryString&&(data=utils.string2binary(data));else{if(o.base64=!1,o.binary=!0,!(dataType||data instanceof CompressedObject))throw new Error("The data of '"+name+"' is in an unsupported format !");"arraybuffer"===dataType&&(data=utils.transformTo("uint8array",data))}var object=new ZipObject(name,data,o);return this.files[name]=object,object},parentFolder=function(path){"/"==path.slice(-1)&&(path=path.substring(0,path.length-1));var lastSlash=path.lastIndexOf("/");return lastSlash>0?path.substring(0,lastSlash):""},folderAdd=function(name){return"/"!=name.slice(-1)&&(name+="/"),this.files[name]||fileAdd.call(this,name,null,{dir:!0}),this.files[name]},generateCompressedObjectFrom=function(file,compression){var result=new CompressedObject,content;return file._data instanceof CompressedObject?(result.uncompressedSize=file._data.uncompressedSize,result.crc32=file._data.crc32,0===result.uncompressedSize||file.options.dir?(compression=compressions.STORE,result.compressedContent="",result.crc32=0):file._data.compressionMethod===compression.magic?result.compressedContent=file._data.getCompressedContent():(content=file._data.getContent(),result.compressedContent=compression.compress(utils.transformTo(compression.compressInputType,content)))):((content=getBinaryData(file))&&0!==content.length&&!file.options.dir||(compression=compressions.STORE,content=""),result.uncompressedSize=content.length,result.crc32=this.crc32(content),result.compressedContent=compression.compress(utils.transformTo(compression.compressInputType,content))),result.compressedSize=result.compressedContent.length,result.compressionMethod=compression.magic,result},generateZipParts=function(name,file,compressedObject,offset){var data=compressedObject.compressedContent,utfEncodedFileName=this.utf8encode(file.name),useUTF8=utfEncodedFileName!==file.name,o=file.options,dosTime,dosDate,extraFields="",unicodePathExtraField="";dosTime=o.date.getHours(),dosTime<<=6,dosTime|=o.date.getMinutes(),dosTime<<=5,dosTime|=o.date.getSeconds()/2,dosDate=o.date.getFullYear()-1980,dosDate<<=4,dosDate|=o.date.getMonth()+1,dosDate<<=5,dosDate|=o.date.getDate(),useUTF8&&(unicodePathExtraField=decToHex(1,1)+decToHex(this.crc32(utfEncodedFileName),4)+utfEncodedFileName,extraFields+="up"+decToHex(unicodePathExtraField.length,2)+unicodePathExtraField);var header="",fileRecord,dirRecord;return header+="\n\0",header+=useUTF8?"\0\b":"\0\0",header+=compressedObject.compressionMethod,header+=decToHex(dosTime,2),header+=decToHex(dosDate,2),header+=decToHex(compressedObject.crc32,4),header+=decToHex(compressedObject.compressedSize,4),header+=decToHex(compressedObject.uncompressedSize,4),header+=decToHex(utfEncodedFileName.length,2),header+=decToHex(extraFields.length,2),{fileRecord:signature.LOCAL_FILE_HEADER+header+utfEncodedFileName+extraFields,dirRecord:signature.CENTRAL_FILE_HEADER+"\0"+header+"\0\0\0\0\0\0"+(!0===file.options.dir?"\0\0\0":"\0\0\0\0")+decToHex(offset,4)+utfEncodedFileName+extraFields,compressedObject:compressedObject}},StringWriter=function(){this.data=[]};StringWriter.prototype={append:function(input){input=utils.transformTo("string",input),this.data.push(input)},finalize:function(){return this.data.join("")}};var Uint8ArrayWriter=function(length){this.data=new Uint8Array(length),this.index=0};Uint8ArrayWriter.prototype={append:function(input){0!==input.length&&(input=utils.transformTo("uint8array",input),this.data.set(input,this.index),this.index+=input.length)},finalize:function(){return this.data}};var out={load:function(stream,options){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(search){var result=[],filename,relativePath,file,fileClone;for(filename in this.files)this.files.hasOwnProperty(filename)&&(file=this.files[filename],fileClone=new ZipObject(file.name,file._data,extend(file.options)),relativePath=filename.slice(this.root.length,filename.length),filename.slice(0,this.root.length)===this.root&&search(relativePath,fileClone)&&result.push(fileClone));return result},file:function(name,data,o){if(1===arguments.length){if(utils.isRegExp(name)){var regexp=name;return this.filter((function(relativePath,file){return!file.options.dir&&regexp.test(relativePath)}))}return this.filter((function(relativePath,file){return!file.options.dir&&relativePath===name}))[0]||null}return name=this.root+name,fileAdd.call(this,name,data,o),this},folder:function(arg){if(!arg)return this;if(utils.isRegExp(arg))return this.filter((function(relativePath,file){return file.options.dir&&arg.test(relativePath)}));var name=this.root+arg,newFolder=folderAdd.call(this,name),ret=this.clone();return ret.root=newFolder.name,ret},remove:function(name){name=this.root+name;var file=this.files[name];if(file||("/"!=name.slice(-1)&&(name+="/"),file=this.files[name]),file)if(file.options.dir)for(var kids=this.filter((function(relativePath,file){return file.name.slice(0,name.length)===name})),i=0;i<kids.length;i++)delete this.files[kids[i].name];else delete this.files[name];return this},generate:function(options){options=extend(options||{},{base64:!0,compression:"STORE",type:"base64"}),utils.checkSupport(options.type);var zipData=[],localDirLength=0,centralDirLength=0,writer,i;for(var name in this.files)if(this.files.hasOwnProperty(name)){var file=this.files[name],compressionName=file.options.compression||options.compression.toUpperCase(),compression=compressions[compressionName];if(!compression)throw new Error(compressionName+" is not a valid compression method !");var compressedObject=generateCompressedObjectFrom.call(this,file,compression),zipPart=generateZipParts.call(this,name,file,compressedObject,localDirLength);localDirLength+=zipPart.fileRecord.length+compressedObject.compressedSize,centralDirLength+=zipPart.dirRecord.length,zipData.push(zipPart)}var dirEnd="";dirEnd=signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(zipData.length,2)+decToHex(zipData.length,2)+decToHex(centralDirLength,4)+decToHex(localDirLength,4)+"\0\0";var typeName=options.type.toLowerCase();for(writer="uint8array"===typeName||"arraybuffer"===typeName||"blob"===typeName||"nodebuffer"===typeName?new Uint8ArrayWriter(localDirLength+centralDirLength+dirEnd.length):new StringWriter(localDirLength+centralDirLength+dirEnd.length),i=0;i<zipData.length;i++)writer.append(zipData[i].fileRecord),writer.append(zipData[i].compressedObject.compressedContent);for(i=0;i<zipData.length;i++)writer.append(zipData[i].dirRecord);writer.append(dirEnd);var zip=writer.finalize();switch(options.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return utils.transformTo(options.type.toLowerCase(),zip);case"blob":return utils.arrayBuffer2Blob(utils.transformTo("arraybuffer",zip));case"base64":return options.base64?base64.encode(zip):zip;default:return zip}},crc32:function crc32(input,crc){if(void 0===input||!input.length)return 0;var isArray="string"!==utils.getTypeOf(input),table=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];void 0===crc&&(crc=0);var x=0,y=0,b=0;crc^=-1;for(var i=0,iTop=input.length;i<iTop;i++)crc=crc>>>8^(x=table[y=255&(crc^(b=isArray?input[i]:input.charCodeAt(i)))]);return-1^crc},utf8encode:function(string){if(textEncoder){var u8=textEncoder.encode(string);return utils.transformTo("string",u8)}if(support.nodebuffer)return utils.transformTo("string",nodeBuffer(string,"utf-8"));for(var result=[],resIndex=0,n=0;n<string.length;n++){var c=string.charCodeAt(n);c<128?result[resIndex++]=String.fromCharCode(c):c>127&&c<2048?(result[resIndex++]=String.fromCharCode(c>>6|192),result[resIndex++]=String.fromCharCode(63&c|128)):(result[resIndex++]=String.fromCharCode(c>>12|224),result[resIndex++]=String.fromCharCode(c>>6&63|128),result[resIndex++]=String.fromCharCode(63&c|128))}return result.join("")},utf8decode:function(input){var result=[],resIndex=0,type,isArray="string"!==utils.getTypeOf(input),i=0,c=0,c1=0,c2=0,c3=0;if(textDecoder)return textDecoder.decode(utils.transformTo("uint8array",input));if(support.nodebuffer)return utils.transformTo("nodebuffer",input).toString("utf-8");for(;i<input.length;)(c=isArray?input[i]:input.charCodeAt(i))<128?(result[resIndex++]=String.fromCharCode(c),i++):c>191&&c<224?(c2=isArray?input[i+1]:input.charCodeAt(i+1),result[resIndex++]=String.fromCharCode((31&c)<<6|63&c2),i+=2):(c2=isArray?input[i+1]:input.charCodeAt(i+1),c3=isArray?input[i+2]:input.charCodeAt(i+2),result[resIndex++]=String.fromCharCode((15&c)<<12|(63&c2)<<6|63&c3),i+=3);return result.join("")}};module.exports=out},{"./base64":7,"./compressedObject":8,"./compressions":9,"./defaults":11,"./nodeBuffer":5,"./signature":16,"./support":18,"./utils":20}],16:[function(_dereq_,module,exports){"use strict";exports.LOCAL_FILE_HEADER="PK",exports.CENTRAL_FILE_HEADER="PK",exports.CENTRAL_DIRECTORY_END="PK",exports.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",exports.ZIP64_CENTRAL_DIRECTORY_END="PK",exports.DATA_DESCRIPTOR="PK\b"},{}],17:[function(_dereq_,module,exports){"use strict";var DataReader=_dereq_("./dataReader"),utils=_dereq_("./utils");function StringReader(data,optimizedBinaryString){this.data=data,optimizedBinaryString||(this.data=utils.string2binary(this.data)),this.length=this.data.length,this.index=0}StringReader.prototype=new DataReader,StringReader.prototype.byteAt=function(i){return this.data.charCodeAt(i)},StringReader.prototype.lastIndexOfSignature=function(sig){return this.data.lastIndexOf(sig)},StringReader.prototype.readData=function(size){this.checkOffset(size);var result=this.data.slice(this.index,this.index+size);return this.index+=size,result},module.exports=StringReader},{"./dataReader":10,"./utils":20}],18:[function(_dereq_,module,exports){(function(process){"use strict";if(exports.base64=!0,exports.array=!0,exports.string=!0,exports.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,exports.nodebuffer=!process.browser,exports.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)exports.blob=!1;else{var buffer=new ArrayBuffer(0);try{exports.blob=0===new Blob([buffer],{type:"application/zip"}).size}catch(e){try{var Builder,builder=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);builder.append(buffer),exports.blob=0===builder.getBlob("application/zip").size}catch(e){exports.blob=!1}}}}).call(this,_dereq_("/Users/cmetcalf/projects/shapefile-js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"))},{"/Users/cmetcalf/projects/shapefile-js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":6}],19:[function(_dereq_,module,exports){"use strict";var DataReader=_dereq_("./dataReader");function Uint8ArrayReader(data){data&&(this.data=data,this.length=this.data.length,this.index=0)}Uint8ArrayReader.prototype=new DataReader,Uint8ArrayReader.prototype.byteAt=function(i){return this.data[i]},Uint8ArrayReader.prototype.lastIndexOfSignature=function(sig){for(var sig0=sig.charCodeAt(0),sig1=sig.charCodeAt(1),sig2=sig.charCodeAt(2),sig3=sig.charCodeAt(3),i=this.length-4;i>=0;--i)if(this.data[i]===sig0&&this.data[i+1]===sig1&&this.data[i+2]===sig2&&this.data[i+3]===sig3)return i;return-1},Uint8ArrayReader.prototype.readData=function(size){this.checkOffset(size);var result=this.data.subarray(this.index,this.index+size);return this.index+=size,result},module.exports=Uint8ArrayReader},{"./dataReader":10}],20:[function(_dereq_,module,exports){"use strict";var support=_dereq_("./support"),compressions=_dereq_("./compressions"),nodeBuffer=_dereq_("./nodeBuffer");function identity(input){return input}function stringToArrayLike(str,array){for(var i=0;i<str.length;++i)array[i]=255&str.charCodeAt(i);return array}function arrayLikeToString(array){var chunk=65536,result=[],len=array.length,type=exports.getTypeOf(array),k=0,canUseApply=!0;try{switch(type){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,nodeBuffer(0))}}catch(e){canUseApply=!1}if(!canUseApply){for(var resultStr="",i=0;i<array.length;i++)resultStr+=String.fromCharCode(array[i]);return resultStr}for(;k<len&&chunk>1;)try{"array"===type||"nodebuffer"===type?result.push(String.fromCharCode.apply(null,array.slice(k,Math.min(k+chunk,len)))):result.push(String.fromCharCode.apply(null,array.subarray(k,Math.min(k+chunk,len)))),k+=chunk}catch(e){chunk=Math.floor(chunk/2)}return result.join("")}function arrayLikeToArrayLike(arrayFrom,arrayTo){for(var i=0;i<arrayFrom.length;i++)arrayTo[i]=arrayFrom[i];return arrayTo}exports.string2binary=function(str){for(var result="",i=0;i<str.length;i++)result+=String.fromCharCode(255&str.charCodeAt(i));return result},exports.string2Uint8Array=function(str){return exports.transformTo("uint8array",str)},exports.uint8Array2String=function(array){return exports.transformTo("string",array)},exports.string2Blob=function(str){var buffer=exports.transformTo("arraybuffer",str);return exports.arrayBuffer2Blob(buffer)},exports.arrayBuffer2Blob=function(buffer){exports.checkSupport("blob");try{return new Blob([buffer],{type:"application/zip"})}catch(e){try{var Builder,builder=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return builder.append(buffer),builder.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var transform={};transform.string={string:identity,array:function(input){return stringToArrayLike(input,new Array(input.length))},arraybuffer:function(input){return transform.string.uint8array(input).buffer},uint8array:function(input){return stringToArrayLike(input,new Uint8Array(input.length))},nodebuffer:function(input){return stringToArrayLike(input,nodeBuffer(input.length))}},transform.array={string:arrayLikeToString,array:identity,arraybuffer:function(input){return new Uint8Array(input).buffer},uint8array:function(input){return new Uint8Array(input)},nodebuffer:function(input){return nodeBuffer(input)}},transform.arraybuffer={string:function(input){return arrayLikeToString(new Uint8Array(input))},array:function(input){return arrayLikeToArrayLike(new Uint8Array(input),new Array(input.byteLength))},arraybuffer:identity,uint8array:function(input){return new Uint8Array(input)},nodebuffer:function(input){return nodeBuffer(new Uint8Array(input))}},transform.uint8array={string:arrayLikeToString,array:function(input){return arrayLikeToArrayLike(input,new Array(input.length))},arraybuffer:function(input){return input.buffer},uint8array:identity,nodebuffer:function(input){return nodeBuffer(input)}},transform.nodebuffer={string:arrayLikeToString,array:function(input){return arrayLikeToArrayLike(input,new Array(input.length))},arraybuffer:function(input){return transform.nodebuffer.uint8array(input).buffer},uint8array:function(input){return arrayLikeToArrayLike(input,new Uint8Array(input.length))},nodebuffer:identity},exports.transformTo=function(outputType,input){if(input||(input=""),!outputType)return input;exports.checkSupport(outputType);var inputType=exports.getTypeOf(input),result;return transform[inputType][outputType](input)},exports.getTypeOf=function(input){return"string"==typeof input?"string":"[object Array]"===Object.prototype.toString.call(input)?"array":support.nodebuffer&&nodeBuffer.test(input)?"nodebuffer":support.uint8array&&input instanceof Uint8Array?"uint8array":support.arraybuffer&&input instanceof ArrayBuffer?"arraybuffer":void 0},exports.checkSupport=function(type){var supported;if(!support[type.toLowerCase()])throw new Error(type+" is not supported by this browser")},exports.MAX_VALUE_16BITS=65535,exports.MAX_VALUE_32BITS=-1,exports.pretty=function(str){var res="",code,i;for(i=0;i<(str||"").length;i++)res+="\\x"+((code=str.charCodeAt(i))<16?"0":"")+code.toString(16).toUpperCase();return res},exports.findCompression=function(compressionMethod){for(var method in compressions)if(compressions.hasOwnProperty(method)&&compressions[method].magic===compressionMethod)return compressions[method];return null},exports.isRegExp=function(object){return"[object RegExp]"===Object.prototype.toString.call(object)}},{"./compressions":9,"./nodeBuffer":5,"./support":18}],21:[function(_dereq_,module,exports){"use strict";var StringReader=_dereq_("./stringReader"),NodeBufferReader=_dereq_("./nodeBufferReader"),Uint8ArrayReader=_dereq_("./uint8ArrayReader"),utils=_dereq_("./utils"),sig=_dereq_("./signature"),ZipEntry=_dereq_("./zipEntry"),support=_dereq_("./support");function ZipEntries(data,loadOptions){this.files=[],this.loadOptions=loadOptions,data&&this.load(data)}ZipEntries.prototype={checkSignature:function(expectedSignature){var signature=this.reader.readString(4);if(signature!==expectedSignature)throw new Error("Corrupted zip or bug : unexpected signature ("+utils.pretty(signature)+", expected "+utils.pretty(expectedSignature)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var extraDataSize=this.zip64EndOfCentralSize-44,index=0,extraFieldId,extraFieldLength,extraFieldValue;0<extraDataSize;)extraFieldId=this.reader.readInt(2),extraFieldLength=this.reader.readInt(4),extraFieldValue=this.reader.readString(extraFieldLength),this.zip64ExtensibleData[extraFieldId]={id:extraFieldId,length:extraFieldLength,value:extraFieldValue}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var i,file;for(i=0;i<this.files.length;i++)file=this.files[i],this.reader.setIndex(file.localHeaderOffset),this.checkSignature(sig.LOCAL_FILE_HEADER),file.readLocalPart(this.reader),file.handleUTF8()},readCentralDir:function(){var file;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===sig.CENTRAL_FILE_HEADER;)(file=new ZipEntry({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(file)},readEndOfCentral:function(){var offset=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(-1===offset)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(offset),this.checkSignature(sig.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===utils.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===utils.MAX_VALUE_16BITS||this.centralDirRecords===utils.MAX_VALUE_16BITS||this.centralDirSize===utils.MAX_VALUE_32BITS||this.centralDirOffset===utils.MAX_VALUE_32BITS){if(this.zip64=!0,-1===(offset=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR)))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(offset),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(data){var type=utils.getTypeOf(data);"string"!==type||support.uint8array?this.reader="nodebuffer"===type?new NodeBufferReader(data):new Uint8ArrayReader(utils.transformTo("uint8array",data)):this.reader=new StringReader(data,this.loadOptions.optimizedBinaryString)},load:function(data){this.prepareReader(data),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},module.exports=ZipEntries},{"./nodeBufferReader":5,"./signature":16,"./stringReader":17,"./support":18,"./uint8ArrayReader":19,"./utils":20,"./zipEntry":22}],22:[function(_dereq_,module,exports){"use strict";var StringReader=_dereq_("./stringReader"),utils=_dereq_("./utils"),CompressedObject=_dereq_("./compressedObject"),jszipProto=_dereq_("./object");function ZipEntry(options,loadOptions){this.options=options,this.loadOptions=loadOptions}ZipEntry.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(reader,from,length){return function(){var previousIndex=reader.index;reader.setIndex(from);var compressedFileData=reader.readData(length);return reader.setIndex(previousIndex),compressedFileData}},prepareContent:function(reader,from,length,compression,uncompressedSize){return function(){var compressedFileData=utils.transformTo(compression.uncompressInputType,this.getCompressedContent()),uncompressedFileData=compression.uncompress(compressedFileData);if(uncompressedFileData.length!==uncompressedSize)throw new Error("Bug : uncompressed data size mismatch");return uncompressedFileData}},readLocalPart:function(reader){var compression,localExtraFieldsLength;if(reader.skip(22),this.fileNameLength=reader.readInt(2),localExtraFieldsLength=reader.readInt(2),this.fileName=reader.readString(this.fileNameLength),reader.skip(localExtraFieldsLength),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(compression=utils.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+utils.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new CompressedObject,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(reader,reader.index,this.compressedSize,compression),this.decompressed.getContent=this.prepareContent(reader,reader.index,this.compressedSize,compression,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=utils.transformTo("string",this.decompressed.getContent()),jszipProto.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(reader){if(this.versionMadeBy=reader.readString(2),this.versionNeeded=reader.readInt(2),this.bitFlag=reader.readInt(2),this.compressionMethod=reader.readString(2),this.date=reader.readDate(),this.crc32=reader.readInt(4),this.compressedSize=reader.readInt(4),this.uncompressedSize=reader.readInt(4),this.fileNameLength=reader.readInt(2),this.extraFieldsLength=reader.readInt(2),this.fileCommentLength=reader.readInt(2),this.diskNumberStart=reader.readInt(2),this.internalFileAttributes=reader.readInt(2),this.externalFileAttributes=reader.readInt(4),this.localHeaderOffset=reader.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=reader.readString(this.fileNameLength),this.readExtraFields(reader),this.parseZIP64ExtraField(reader),this.fileComment=reader.readString(this.fileCommentLength),this.dir=!!(16&this.externalFileAttributes)},parseZIP64ExtraField:function(reader){if(this.extraFields[1]){var extraReader=new StringReader(this.extraFields[1].value);this.uncompressedSize===utils.MAX_VALUE_32BITS&&(this.uncompressedSize=extraReader.readInt(8)),this.compressedSize===utils.MAX_VALUE_32BITS&&(this.compressedSize=extraReader.readInt(8)),this.localHeaderOffset===utils.MAX_VALUE_32BITS&&(this.localHeaderOffset=extraReader.readInt(8)),this.diskNumberStart===utils.MAX_VALUE_32BITS&&(this.diskNumberStart=extraReader.readInt(4))}},readExtraFields:function(reader){var start=reader.index,extraFieldId,extraFieldLength,extraFieldValue;for(this.extraFields=this.extraFields||{};reader.index<start+this.extraFieldsLength;)extraFieldId=reader.readInt(2),extraFieldLength=reader.readInt(2),extraFieldValue=reader.readString(extraFieldLength),this.extraFields[extraFieldId]={id:extraFieldId,length:extraFieldLength,value:extraFieldValue}},handleUTF8:function(){if(this.useUTF8())this.fileName=jszipProto.utf8decode(this.fileName),this.fileComment=jszipProto.utf8decode(this.fileComment);else{var upath=this.findExtraFieldUnicodePath();null!==upath&&(this.fileName=upath)}},findExtraFieldUnicodePath:function(){var upathField=this.extraFields[28789];if(upathField){var extraReader=new StringReader(upathField.value);return 1!==extraReader.readInt(1)?null:jszipProto.crc32(this.fileName)!==extraReader.readInt(4)?null:jszipProto.utf8decode(extraReader.readString(upathField.length-5))}return null}},module.exports=ZipEntry},{"./compressedObject":8,"./object":15,"./stringReader":17,"./utils":20}],23:[function(_dereq_,module,exports){(function(){"use strict";var n=void 0,u=!0,aa=this;function ba(e,d){var c=e.split("."),f=aa,a;!(c[0]in f)&&f.execScript&&f.execScript("var "+c[0]);for(;c.length&&(a=c.shift());)c.length||d===n?f=f[a]?f[a]:f[a]={}:f[a]=d}var C="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;function K(e,d){if(this.index="number"==typeof d?d:0,this.d=0,this.buffer=e instanceof(C?Uint8Array:Array)?e:new(C?Uint8Array:Array)(32768),2*this.buffer.length<=this.index)throw Error("invalid index");this.buffer.length<=this.index&&ca(this)}function ca(e){var d=e.buffer,c,f=d.length,a=new(C?Uint8Array:Array)(f<<1);if(C)a.set(d);else for(c=0;c<f;++c)a[c]=d[c];return e.buffer=a}K.prototype.a=function(e,d,c){var f=this.buffer,a=this.index,b=this.d,k=f[a],m;if(c&&1<d&&(e=8<d?(L[255&e]<<24|L[e>>>8&255]<<16|L[e>>>16&255]<<8|L[e>>>24&255])>>32-d:L[e]>>8-d),8>d+b)k=k<<d|e,b+=d;else for(m=0;m<d;++m)k=k<<1|e>>d-m-1&1,8==++b&&(b=0,f[a++]=L[k],k=0,a===f.length&&(f=ca(this)));f[a]=k,this.buffer=f,this.d=b,this.index=a},K.prototype.finish=function(){var e=this.buffer,d=this.index,c;return 0<this.d&&(e[d]<<=8-this.d,e[d]=L[e[d]],d++),C?c=e.subarray(0,d):(e.length=d,c=e),c};var ga=new(C?Uint8Array:Array)(256),M;for(M=0;256>M;++M){for(var R,S=R=M,ha=7,R=R>>>1;R;R>>>=1)S<<=1,S|=1&R,--ha;ga[M]=(S<<ha&255)>>>0}var L=ga;function ja(e){this.buffer=new(C?Uint16Array:Array)(2*e),this.length=0}function ka(e,d){this.e=ma,this.f=0,this.input=C&&e instanceof Array?new Uint8Array(e):e,this.c=0,d&&(d.lazy&&(this.f=d.lazy),"number"==typeof d.compressionType&&(this.e=d.compressionType),d.outputBuffer&&(this.b=C&&d.outputBuffer instanceof Array?new Uint8Array(d.outputBuffer):d.outputBuffer),"number"==typeof d.outputIndex&&(this.c=d.outputIndex)),this.b||(this.b=new(C?Uint8Array:Array)(32768))}ja.prototype.getParent=function(e){return 2*((e-2)/4|0)},ja.prototype.push=function(e,d){var c,f,a=this.buffer,b;for(c=this.length,a[this.length++]=d,a[this.length++]=e;0<c&&(f=this.getParent(c),a[c]>a[f]);)b=a[c],a[c]=a[f],a[f]=b,b=a[c+1],a[c+1]=a[f+1],a[f+1]=b,c=f;return this.length},ja.prototype.pop=function(){var e,d,c=this.buffer,f,a,b;for(d=c[0],e=c[1],this.length-=2,c[0]=c[this.length],c[1]=c[this.length+1],b=0;!((a=2*b+2)>=this.length)&&(a+2<this.length&&c[a+2]>c[a]&&(a+=2),c[a]>c[b]);)f=c[b],c[b]=c[a],c[a]=f,f=c[b+1],c[b+1]=c[a+1],c[a+1]=f,b=a;return{index:e,value:d,length:this.length}};var ma=2,T=[],U;for(U=0;288>U;U++)switch(u){case 143>=U:T.push([U+48,8]);break;case 255>=U:T.push([U-144+400,9]);break;case 279>=U:T.push([U-256+0,7]);break;case 287>=U:T.push([U-280+192,8]);break;default:throw"invalid literal: "+U}function qa(e,d){this.length=e,this.g=d}ka.prototype.h=function(){var e,d,c,f,a=this.input;switch(this.e){case 0:for(c=0,f=a.length;c<f;){var b=d=C?a.subarray(c,c+65535):a.slice(c,c+65535),k=(c+=d.length)===f,m=n,g=n,p=n,v=n,x=n,l=this.b,h=this.c;if(C){for(l=new Uint8Array(this.b.buffer);l.length<=h+b.length+5;)l=new Uint8Array(l.length<<1);l.set(this.b)}if(m=k?1:0,l[h++]=0|m,p=65536+~(g=b.length)&65535,l[h++]=255&g,l[h++]=g>>>8&255,l[h++]=255&p,l[h++]=p>>>8&255,C)l.set(b,h),h+=b.length,l=l.subarray(0,h);else{for(v=0,x=b.length;v<x;++v)l[h++]=b[v];l.length=h}this.c=h,this.b=l}break;case 1:var q=new K(C?new Uint8Array(this.b.buffer):this.b,this.c);q.a(1,1,u),q.a(1,2,u);var t=na(this,a),w,da,z;for(w=0,da=t.length;w<da;w++)if(z=t[w],K.prototype.a.apply(q,T[z]),256<z)q.a(t[++w],t[++w],u),q.a(t[++w],5),q.a(t[++w],t[++w],u);else if(256===z)break;this.b=q.finish(),this.c=this.b.length;break;case ma:var B=new K(C?new Uint8Array(this.b.buffer):this.b,this.c),ra,J,N,O,P,Ia=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W,sa,X,ta,ea,ia=Array(19),ua,Q,fa,y,va;for(ra=ma,B.a(1,1,u),B.a(ra,2,u),J=na(this,a),sa=pa(W=oa(this.j,15)),ta=pa(X=oa(this.i,7)),N=286;257<N&&0===W[N-1];N--);for(O=30;1<O&&0===X[O-1];O--);var wa=N,xa=O,F=new(C?Uint32Array:Array)(wa+xa),r,G,s,Y,E=new(C?Uint32Array:Array)(316),D,A,H=new(C?Uint8Array:Array)(19);for(r=G=0;r<wa;r++)F[G++]=W[r];for(r=0;r<xa;r++)F[G++]=X[r];if(!C)for(r=0,Y=H.length;r<Y;++r)H[r]=0;for(r=D=0,Y=F.length;r<Y;r+=G){for(G=1;r+G<Y&&F[r+G]===F[r];++G);if(s=G,0===F[r])if(3>s)for(;0<s--;)E[D++]=0,H[0]++;else for(;0<s;)(A=138>s?s:138)>s-3&&A<s&&(A=s-3),10>=A?(E[D++]=17,E[D++]=A-3,H[17]++):(E[D++]=18,E[D++]=A-11,H[18]++),s-=A;else if(E[D++]=F[r],H[F[r]]++,3>--s)for(;0<s--;)E[D++]=F[r],H[F[r]]++;else for(;0<s;)(A=6>s?s:6)>s-3&&A<s&&(A=s-3),E[D++]=16,E[D++]=A-3,H[16]++,s-=A}for(e=C?E.subarray(0,D):E.slice(0,D),ea=oa(H,7),y=0;19>y;y++)ia[y]=ea[Ia[y]];for(P=19;4<P&&0===ia[P-1];P--);for(ua=pa(ea),B.a(N-257,5,u),B.a(O-1,5,u),B.a(P-4,4,u),y=0;y<P;y++)B.a(ia[y],3,u);for(y=0,va=e.length;y<va;y++)if(Q=e[y],B.a(ua[Q],ea[Q],u),16<=Q){switch(y++,Q){case 16:fa=2;break;case 17:fa=3;break;case 18:fa=7;break;default:throw"invalid code: "+Q}B.a(e[y],fa,u)}var ya=[sa,W],za=[ta,X],I,Aa,Z,la,Ba,Ca,Da,Ea;for(Ba=ya[0],Ca=ya[1],Da=za[0],Ea=za[1],I=0,Aa=J.length;I<Aa;++I)if(Z=J[I],B.a(Ba[Z],Ca[Z],u),256<Z)B.a(J[++I],J[++I],u),la=J[++I],B.a(Da[la],Ea[la],u),B.a(J[++I],J[++I],u);else if(256===Z)break;this.b=B.finish(),this.c=this.b.length;break;default:throw"invalid compression type"}return this.b};var Fa=function(){function e(a){switch(u){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:throw"invalid length: "+a}}var d=[],c,f;for(c=3;258>=c;c++)f=e(c),d[c]=f[2]<<24|f[1]<<16|f[0];return d}(),Ga=C?new Uint32Array(Fa):Fa;function na(e,d){function c(a,c){var b=a.g,d=[],f=0,e,g,k,m;switch(e=Ga[a.length],d[f++]=65535&e,d[f++]=e>>16&255,d[f++]=e>>24,u){case 1===b:g=[0,b-1,0];break;case 2===b:g=[1,b-2,0];break;case 3===b:g=[2,b-3,0];break;case 4===b:g=[3,b-4,0];break;case 6>=b:g=[4,b-5,1];break;case 8>=b:g=[5,b-7,1];break;case 12>=b:g=[6,b-9,2];break;case 16>=b:g=[7,b-13,2];break;case 24>=b:g=[8,b-17,3];break;case 32>=b:g=[9,b-25,3];break;case 48>=b:g=[10,b-33,4];break;case 64>=b:g=[11,b-49,4];break;case 96>=b:g=[12,b-65,5];break;case 128>=b:g=[13,b-97,5];break;case 192>=b:g=[14,b-129,6];break;case 256>=b:g=[15,b-193,6];break;case 384>=b:g=[16,b-257,7];break;case 512>=b:g=[17,b-385,7];break;case 768>=b:g=[18,b-513,8];break;case 1024>=b:g=[19,b-769,8];break;case 1536>=b:g=[20,b-1025,9];break;case 2048>=b:g=[21,b-1537,9];break;case 3072>=b:g=[22,b-2049,10];break;case 4096>=b:g=[23,b-3073,10];break;case 6144>=b:g=[24,b-4097,11];break;case 8192>=b:g=[25,b-6145,11];break;case 12288>=b:g=[26,b-8193,12];break;case 16384>=b:g=[27,b-12289,12];break;case 24576>=b:g=[28,b-16385,13];break;case 32768>=b:g=[29,b-24577,13];break;default:throw"invalid distance"}for(e=g,d[f++]=e[0],d[f++]=e[1],d[f++]=e[2],k=0,m=d.length;k<m;++k)l[h++]=d[k];t[d[0]]++,w[d[3]]++,q=a.length+c-1,x=null}var f,a,b,k,m,g={},p,v,x,l=C?new Uint16Array(2*d.length):[],h=0,q=0,t=new(C?Uint32Array:Array)(286),w=new(C?Uint32Array:Array)(30),da=e.f,z;if(!C){for(b=0;285>=b;)t[b++]=0;for(b=0;29>=b;)w[b++]=0}for(t[256]=1,f=0,a=d.length;f<a;++f){for(b=m=0,k=3;b<k&&f+b!==a;++b)m=m<<8|d[f+b];if(g[m]===n&&(g[m]=[]),p=g[m],!(0<q--)){for(;0<p.length&&32768<f-p[0];)p.shift();if(f+3>=a){for(x&&c(x,-1),b=0,k=a-f;b<k;++b)z=d[f+b],l[h++]=z,++t[z];break}0<p.length?(v=Ha(d,f,p),x?x.length<v.length?(z=d[f-1],l[h++]=z,++t[z],c(v,0)):c(x,-1):v.length<da?x=v:c(v,0)):x?c(x,-1):(z=d[f],l[h++]=z,++t[z])}p.push(f)}return l[h++]=256,t[256]++,e.j=t,e.i=w,C?l.subarray(0,h):l}function Ha(e,d,c){var f,a,b=0,k,m,g,p,v=e.length;m=0,p=c.length;a:for(;m<p;m++){if(f=c[p-m-1],k=3,3<b){for(g=b;3<g;g--)if(e[f+g-1]!==e[d+g-1])continue a;k=b}for(;258>k&&d+k<v&&e[f+k]===e[d+k];)++k;if(k>b&&(a=f,b=k),258===k)break}return new qa(b,d-a)}function oa(e,d){var c=e.length,f=new ja(572),a=new(C?Uint8Array:Array)(c),b,k,m,g,p;if(!C)for(g=0;g<c;g++)a[g]=0;for(g=0;g<c;++g)0<e[g]&&f.push(g,e[g]);if(b=Array(f.length/2),k=new(C?Uint32Array:Array)(f.length/2),1===b.length)return a[f.pop().index]=1,a;for(g=0,p=f.length/2;g<p;++g)b[g]=f.pop(),k[g]=b[g].value;for(m=Ja(k,k.length,d),g=0,p=b.length;g<p;++g)a[b[g].index]=m[g];return a}function Ja(e,d,c){function f(a){var b=g[a][p[a]];b===d?(f(a+1),f(a+1)):--k[b],++p[a]}var a=new(C?Uint16Array:Array)(c),b=new(C?Uint8Array:Array)(c),k=new(C?Uint8Array:Array)(d),m=Array(c),g=Array(c),p=Array(c),v=(1<<c)-d,x=1<<c-1,l,h,q,t,w;for(a[c-1]=d,h=0;h<c;++h)v<x?b[h]=0:(b[h]=1,v-=x),v<<=1,a[c-2-h]=(a[c-1-h]/2|0)+d;for(a[0]=b[0],m[0]=Array(a[0]),g[0]=Array(a[0]),h=1;h<c;++h)a[h]>2*a[h-1]+b[h]&&(a[h]=2*a[h-1]+b[h]),m[h]=Array(a[h]),g[h]=Array(a[h]);for(l=0;l<d;++l)k[l]=c;for(q=0;q<a[c-1];++q)m[c-1][q]=e[q],g[c-1][q]=q;for(l=0;l<c;++l)p[l]=0;for(1===b[c-1]&&(--k[0],++p[c-1]),h=c-2;0<=h;--h){for(t=l=0,w=p[h+1],q=0;q<a[h];q++)(t=m[h+1][w]+m[h+1][w+1])>e[l]?(m[h][q]=t,g[h][q]=d,w+=2):(m[h][q]=e[l],g[h][q]=l,++l);p[h]=0,1===b[h]&&f(h)}return k}function pa(e){var d=new(C?Uint16Array:Array)(e.length),c=[],f=[],a=0,b,k,m,g;for(b=0,k=e.length;b<k;b++)c[e[b]]=1+(0|c[e[b]]);for(b=1,k=16;b<=k;b++)f[b]=a,a+=0|c[b],a<<=1;for(b=0,k=e.length;b<k;b++)for(a=f[e[b]],f[e[b]]+=1,m=d[b]=0,g=e[b];m<g;m++)d[b]=d[b]<<1|1&a,a>>>=1;return d}ba("Zlib.RawDeflate",ka),ba("Zlib.RawDeflate.prototype.compress",ka.prototype.h);var Ka={NONE:0,FIXED:1,DYNAMIC:ma},V,La,$,Ma;if(Object.keys)V=Object.keys(Ka);else for(La in V=[],$=0,Ka)V[$++]=La;for($=0,Ma=V.length;$<Ma;++$)ba("Zlib.RawDeflate.CompressionType."+(La=V[$]),Ka[La])}).call(this)},{}],24:[function(_dereq_,module,exports){(function(){"use strict";var l=void 0,p=this;function q(c,d){var a=c.split("."),b=p,e;!(a[0]in b)&&b.execScript&&b.execScript("var "+a[0]);for(;a.length&&(e=a.shift());)a.length||d===l?b=b[e]?b[e]:b[e]={}:b[e]=d}var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array;function u(c){var d=c.length,a=0,b=Number.POSITIVE_INFINITY,e,f,g,h,k,m,s,n,t;for(n=0;n<d;++n)c[n]>a&&(a=c[n]),c[n]<b&&(b=c[n]);for(e=1<<a,f=new(r?Uint32Array:Array)(e),g=1,h=0,k=2;g<=a;){for(n=0;n<d;++n)if(c[n]===g){for(m=0,s=h,t=0;t<g;++t)m=m<<1|1&s,s>>=1;for(t=m;t<e;t+=k)f[t]=g<<16|n;++h}++g,h<<=1,k<<=1}return[f,a,b]}function v(c,d){switch(this.g=[],this.h=32768,this.c=this.f=this.d=this.k=0,this.input=r?new Uint8Array(c):c,this.l=!1,this.i=w,this.p=!1,!d&&(d={})||(d.index&&(this.d=d.index),d.bufferSize&&(this.h=d.bufferSize),d.bufferType&&(this.i=d.bufferType),d.resize&&(this.p=d.resize)),this.i){case x:this.a=32768,this.b=new(r?Uint8Array:Array)(32768+this.h+258);break;case w:this.a=0,this.b=new(r?Uint8Array:Array)(this.h),this.e=this.u,this.m=this.r,this.j=this.s;break;default:throw Error("invalid inflate mode")}}var x=0,w=1;v.prototype.t=function(){for(;!this.l;){var c=y(this,3);switch(1&c&&(this.l=!0),c>>>=1){case 0:var d=this.input,a=this.d,b=this.b,e=this.a,f=l,g=l,h=l,k=b.length,m=l;if(this.c=this.f=0,(f=d[a++])===l)throw Error("invalid uncompressed block header: LEN (first byte)");if(g=f,(f=d[a++])===l)throw Error("invalid uncompressed block header: LEN (second byte)");if(g|=f<<8,(f=d[a++])===l)throw Error("invalid uncompressed block header: NLEN (first byte)");if(h=f,(f=d[a++])===l)throw Error("invalid uncompressed block header: NLEN (second byte)");if(g===~(h|=f<<8))throw Error("invalid uncompressed block header: length verify");if(a+g>d.length)throw Error("input buffer is broken");switch(this.i){case x:for(;e+g>b.length;){if(g-=m=k-e,r)b.set(d.subarray(a,a+m),e),e+=m,a+=m;else for(;m--;)b[e++]=d[a++];this.a=e,b=this.e(),e=this.a}break;case w:for(;e+g>b.length;)b=this.e({o:2});break;default:throw Error("invalid inflate mode")}if(r)b.set(d.subarray(a,a+g),e),e+=g,a+=g;else for(;g--;)b[e++]=d[a++];this.d=a,this.a=e,this.b=b;break;case 1:this.j(z,A);break;case 2:B(this);break;default:throw Error("unknown BTYPE: "+c)}}return this.m()};var C=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=r?new Uint16Array(C):C,E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],F=r?new Uint16Array(E):E,G=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],H=r?new Uint8Array(G):G,I=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],J=r?new Uint16Array(I):I,K=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],L=r?new Uint8Array(K):K,M=new(r?Uint8Array:Array)(288),N,O;for(N=0,O=M.length;N<O;++N)M[N]=143>=N?8:255>=N?9:279>=N?7:8;var z=u(M),P=new(r?Uint8Array:Array)(30),Q,R;for(Q=0,R=P.length;Q<R;++Q)P[Q]=5;var A=u(P);function y(c,d){for(var a=c.f,b=c.c,e=c.input,f=c.d,g;b<d;){if((g=e[f++])===l)throw Error("input buffer is broken");a|=g<<b,b+=8}return g=a&(1<<d)-1,c.f=a>>>d,c.c=b-d,c.d=f,g}function S(c,d){for(var a=c.f,b=c.c,e=c.input,f=c.d,g=d[0],h=d[1],k,m,s;b<h&&(k=e[f++])!==l;)a|=k<<b,b+=8;return s=(m=g[a&(1<<h)-1])>>>16,c.f=a>>s,c.c=b-s,c.d=f,65535&m}function B(c){function d(a,c,b){var d,f,e,g;for(g=0;g<a;)switch(d=S(this,c),d){case 16:for(e=3+y(this,2);e--;)b[g++]=f;break;case 17:for(e=3+y(this,3);e--;)b[g++]=0;f=0;break;case 18:for(e=11+y(this,7);e--;)b[g++]=0;f=0;break;default:f=b[g++]=d}return b}var a=y(c,5)+257,b=y(c,5)+1,e=y(c,4)+4,f=new(r?Uint8Array:Array)(D.length),g,h,k,m;for(m=0;m<e;++m)f[D[m]]=y(c,3);g=u(f),h=new(r?Uint8Array:Array)(a),k=new(r?Uint8Array:Array)(b),c.j(u(d.call(c,a,g,h)),u(d.call(c,b,g,k)))}v.prototype.j=function(c,d){var a=this.b,b=this.a;this.n=c;for(var e=a.length-258,f,g,h,k;256!==(f=S(this,c));)if(256>f)b>=e&&(this.a=b,a=this.e(),b=this.a),a[b++]=f;else for(k=F[g=f-257],0<H[g]&&(k+=y(this,H[g])),f=S(this,d),h=J[f],0<L[f]&&(h+=y(this,L[f])),b>=e&&(this.a=b,a=this.e(),b=this.a);k--;)a[b]=a[b++-h];for(;8<=this.c;)this.c-=8,this.d--;this.a=b},v.prototype.s=function(c,d){var a=this.b,b=this.a;this.n=c;for(var e=a.length,f,g,h,k;256!==(f=S(this,c));)if(256>f)b>=e&&(e=(a=this.e()).length),a[b++]=f;else for(k=F[g=f-257],0<H[g]&&(k+=y(this,H[g])),f=S(this,d),h=J[f],0<L[f]&&(h+=y(this,L[f])),b+k>e&&(e=(a=this.e()).length);k--;)a[b]=a[b++-h];for(;8<=this.c;)this.c-=8,this.d--;this.a=b},v.prototype.e=function(){var c=new(r?Uint8Array:Array)(this.a-32768),d=this.a-32768,a,b,e=this.b;if(r)c.set(e.subarray(32768,c.length));else for(a=0,b=c.length;a<b;++a)c[a]=e[a+32768];if(this.g.push(c),this.k+=c.length,r)e.set(e.subarray(d,d+32768));else for(a=0;32768>a;++a)e[a]=e[d+a];return this.a=32768,e},v.prototype.u=function(c){var d,a=this.input.length/this.d+1|0,b,e,f,g=this.input,h=this.b;return c&&("number"==typeof c.o&&(a=c.o),"number"==typeof c.q&&(a+=c.q)),2>a?e=(f=(b=(g.length-this.d)/this.n[2])/2*258|0)<h.length?h.length+f:h.length<<1:e=h.length*a,r?(d=new Uint8Array(e)).set(h):d=h,this.b=d},v.prototype.m=function(){var c=0,d=this.b,a=this.g,b,e=new(r?Uint8Array:Array)(this.k+(this.a-32768)),f,g,h,k;if(0===a.length)return r?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);for(f=0,g=a.length;f<g;++f)for(h=0,k=(b=a[f]).length;h<k;++h)e[c++]=b[h];for(f=32768,g=this.a;f<g;++f)e[c++]=d[f];return this.g=[],this.buffer=e},v.prototype.r=function(){var c,d=this.a;return r?this.p?(c=new Uint8Array(d)).set(this.b.subarray(0,d)):c=this.b.subarray(0,d):(this.b.length>d&&(this.b.length=d),c=this.b),this.buffer=c},q("Zlib.RawInflate",v),q("Zlib.RawInflate.prototype.decompress",v.prototype.t);var T={ADAPTIVE:w,BLOCK:x},U,V,W,X;if(Object.keys)U=Object.keys(T);else for(V in U=[],W=0,T)U[W++]=V;for(W=0,X=U.length;W<X;++W)q("Zlib.RawInflate.BufferType."+(V=U[W]),T[V])}).call(this)},{}],25:[function(_dereq_,module,exports){var promise=_dereq_("lie"),cast=_dereq_("lie-cast"),qMap=_dereq_("lie-quickmap"),each=_dereq_("lie-quickeach"),use=_dereq_("lie-use");function all(array){return promise((function(fulfill,reject){var len=array.length;len||fulfill([]);var fulfilled=0,out=[],onSuccess=function(n){return function(v){out[n]=v,++fulfilled===len&&fulfill(out)}};each(qMap(array,cast),(function(v,i){v.then(onSuccess(i),(function(a){reject(a)}))}))}))}module.exports=function(array){return use(array,all)}},{lie:31,"lie-cast":26,"lie-quickeach":28,"lie-quickmap":29,"lie-use":30}],26:[function(_dereq_,module,exports){var resolve=_dereq_("lie-resolve"),promise=_dereq_("lie");function cast(thing){return thing instanceof promise?thing:resolve(thing)}module.exports=cast},{lie:31,"lie-resolve":27}],27:[function(_dereq_,module,exports){var promise=_dereq_("lie");function resolve(value){return promise((function(yes){yes(value)}))}module.exports=resolve},{lie:31}],28:[function(_dereq_,module,exports){function quickEach(arr,func){var len=arr.length;if(len)for(var i=-1;++i<len;)func(arr[i],i)}module.exports=quickEach},{}],29:[function(_dereq_,module,exports){function quickMap(arr,func){var len=arr.length;if(!len)return[];var i=-1,out=new Array(len);if("function"==typeof func)for(;++i<len;)out[i]=func(arr[i],i);else for(;++i<len;)out[i]=arr[i];return out}module.exports=quickMap},{}],30:[function(_dereq_,module,exports){function use(thing,func){return"function"==typeof thing.then?thing.then(func):func(thing)}module.exports=use},{}],31:[function(_dereq_,module,exports){"use strict";var immediate=_dereq_("immediate"),isDefineProp=!1;function defineNonEnum(obj,name,value){isDefineProp?Object.defineProperty(obj,name,{value:value,configurable:!0,writable:!0}):obj[name]=value}function Promise(resolver){if(!(this instanceof Promise))return new Promise(resolver);defineNonEnum(this,"successQueue",[]),defineNonEnum(this,"failureQueue",[]),defineNonEnum(this,"resolved",!1),"function"==typeof resolver&&this.resolvePassed(resolver)}function unwrap(fulfill,reject,value){value&&"function"==typeof value.then?value.then(fulfill,reject):fulfill(value)}function createResolved(scope,value,whichArg){function resolved(){var callback=arguments[whichArg];return"function"!=typeof callback?scope:new Promise((function(resolve,reject){immediate(execute,callback,value,resolve,reject)}))}return resolved}function execute(callback,value,resolve,reject){try{unwrap(resolve,reject,callback(value))}catch(error){reject(error)}}!function(){try{Object.defineProperty({},"test",{value:!0}),isDefineProp=!0}catch(e){}}(),defineNonEnum(Promise.prototype,"resolvePassed",(function(resolver){try{resolver(this.fulfillUnwrap.bind(this),this.reject.bind(this))}catch(e){this.reject(e)}})),defineNonEnum(Promise.prototype,"reject",(function(reason){this.resolve(!1,reason)})),defineNonEnum(Promise.prototype,"fulfill",(function(value){this.resolve(!0,value)})),defineNonEnum(Promise.prototype,"fulfillUnwrap",(function(value){unwrap(this.fulfill.bind(this),this.reject.bind(this),value)})),Promise.prototype.then=function(onFulfilled,onRejected){return this.resolved?this.resolved(onFulfilled,onRejected):this.pending(onFulfilled,onRejected)},function(){try{Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)}}catch(e){}}(),defineNonEnum(Promise.prototype,"pending",(function(onFulfilled,onRejected){var self=this;return new Promise((function(success,failure){"function"==typeof onFulfilled?self.successQueue.push({resolve:success,reject:failure,callback:onFulfilled}):self.successQueue.push({next:success,callback:!1}),"function"==typeof onRejected?self.failureQueue.push({resolve:success,reject:failure,callback:onRejected}):self.failureQueue.push({next:failure,callback:!1})}))})),defineNonEnum(Promise.prototype,"resolve",(function(success,value){if(!this.resolved){this.resolved=createResolved(this,value,success?0:1);for(var queue=success?this.successQueue:this.failureQueue,len=queue.length,i=-1;++i<len;)queue[i].callback?immediate(execute,queue[i].callback,value,queue[i].resolve,queue[i].reject):queue[i].next(value)}})),module.exports=Promise},{immediate:34}],32:[function(_dereq_,module,exports){"use strict";exports.test=function(){return!1}},{}],33:[function(_dereq_,module,exports){(function(global){module.exports="object"==typeof global&&global?global:this}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(_dereq_,module,exports){"use strict";var types=[_dereq_("./nextTick"),_dereq_("./mutation"),_dereq_("./realSetImmediate"),_dereq_("./postMessage"),_dereq_("./messageChannel"),_dereq_("./stateChange"),_dereq_("./timeout")],handlerQueue=[],nextTick;function drainQueue(){var i=0,task,innerQueue=handlerQueue;for(handlerQueue=[];task=innerQueue[i++];)task()}for(var i=-1,len=types.length;++i<len;)if(types[i].test()){nextTick=types[i].install(drainQueue);break}var retFunc=function(task){var len,args,nTask=task;return arguments.length>1&&"function"==typeof task&&(args=Array.prototype.slice.call(arguments,1),nTask=function(){task.apply(void 0,args)}),1===(len=handlerQueue.push(nTask))&&nextTick(drainQueue),len};retFunc.clear=function(n){return n<=handlerQueue.length&&(handlerQueue[n-1]=function(){}),this},module.exports=retFunc},{"./messageChannel":35,"./mutation":36,"./nextTick":32,"./postMessage":37,"./realSetImmediate":38,"./stateChange":39,"./timeout":40}],35:[function(_dereq_,module,exports){"use strict";var globe=_dereq_("./global");exports.test=function(){return!!globe.MessageChannel},exports.install=function(func){var channel=new globe.MessageChannel;return channel.port1.onmessage=func,function(){channel.port2.postMessage(0)}}},{"./global":33}],36:[function(_dereq_,module,exports){"use strict";var globe=_dereq_("./global"),MutationObserver=globe.MutationObserver||globe.WebKitMutationObserver;exports.test=function(){return MutationObserver},exports.install=function(handle){var observer=new MutationObserver(handle),element=globe.document.createElement("div");return observer.observe(element,{attributes:!0}),globe.addEventListener("unload",(function(){observer.disconnect(),observer=null}),!1),function(){element.setAttribute("drainQueue","drainQueue")}}},{"./global":33}],37:[function(_dereq_,module,exports){"use strict";var globe=_dereq_("./global");exports.test=function(){if(!globe.postMessage||globe.importScripts)return!1;var postMessageIsAsynchronous=!0,oldOnMessage=globe.onmessage;return globe.onmessage=function(){postMessageIsAsynchronous=!1},globe.postMessage("","*"),globe.onmessage=oldOnMessage,postMessageIsAsynchronous},exports.install=function(func){var codeWord="com.calvinmetcalf.setImmediate"+Math.random();function globalMessage(event){event.source===globe&&event.data===codeWord&&func()}return globe.addEventListener?globe.addEventListener("message",globalMessage,!1):globe.attachEvent("onmessage",globalMessage),function(){globe.postMessage(codeWord,"*")}}},{"./global":33}],38:[function(_dereq_,module,exports){"use strict";var globe=_dereq_("./global");exports.test=function(){return globe.setImmediate},exports.install=function(handle){return globe.setTimeout.bind(globe,handle,0)}},{"./global":33}],39:[function(_dereq_,module,exports){"use strict";var globe=_dereq_("./global");exports.test=function(){return"document"in globe&&"onreadystatechange"in globe.document.createElement("script")},exports.install=function(handle){return function(){var scriptEl=globe.document.createElement("script");return scriptEl.onreadystatechange=function(){handle(),scriptEl.onreadystatechange=null,scriptEl.parentNode.removeChild(scriptEl),scriptEl=null},globe.document.documentElement.appendChild(scriptEl),handle}}},{"./global":33}],40:[function(_dereq_,module,exports){"use strict";exports.test=function(){return!0},exports.install=function(t){return function(){setTimeout(t,0)}}},{}],41:[function(_dereq_,module,exports){function dbfHeader(buffer){var data=new DataView(buffer),out={};return out.lastUpdated=new Date(data.getUint8(1,!0)+1900,data.getUint8(2,!0),data.getUint8(3,!0)),out.records=data.getUint32(4,!0),out.headerLen=data.getUint16(8,!0),out.recLen=data.getUint16(10,!0),out}function dbfRowHeader(buffer){for(var data=new DataView(buffer),out=[],offset=32;out.push({name:String.fromCharCode.apply(this,new Uint8Array(buffer,offset,10)).replace(/\0|\s+$/g,""),dataType:String.fromCharCode(data.getUint8(offset+11)),len:data.getUint8(offset+16),decimal:data.getUint8(offset+17)}),13!==data.getUint8(offset+32);)offset+=32;return out}function rowFuncs(buffer,offset,len,type){var data=new Uint8Array(buffer,offset,len),textData=String.fromCharCode.apply(this,data).replace(/\0|\s+$/g,"");switch(type){case"N":case"F":case"O":return parseFloat(textData,10);case"D":return new Date(textData.slice(0,4),parseInt(textData.slice(4,6),10)-1,textData.slice(6,8));case"L":return"y"===textData.toLowerCase()||"t"===textData.toLowerCase();default:return textData}}function parseRow(buffer,offset,rowHeaders){for(var out={},i=0,len=rowHeaders.length,field,header;i<len;)field=rowFuncs(buffer,offset,(header=rowHeaders[i]).len,header.dataType),offset+=header.len,void 0!==field&&(out[header.name]=field),i++;return out}module.exports=function(buffer){for(var rowHeaders=dbfRowHeader(buffer),header=dbfHeader(buffer),offset=2+(rowHeaders.length+1<<5),recLen=header.recLen,records=header.records,out=[];records;)out.push(parseRow(buffer,offset,rowHeaders)),offset+=recLen,records--;return out}},{}],42:[function(_dereq_,module,exports){var mgrs=_dereq_("mgrs");function Point(x,y,z){if(!(this instanceof Point))return new Point(x,y,z);if(Array.isArray(x))this.x=x[0],this.y=x[1],this.z=x[2]||0;else if("object"==typeof x)this.x=x.x,this.y=x.y,this.z=x.z||0;else if("string"==typeof x&&void 0===y){var coords=x.split(",");this.x=parseFloat(coords[0],10),this.y=parseFloat(coords[1],10),this.z=parseFloat(coords[2],10)||0}else this.x=x,this.y=y,this.z=z||0;this.clone=function(){return new Point(this.x,this.y,this.z)},this.toArray=function(){return this.z?[this.x,this.y,this.z]:[this.x,this.y]},this.toString=function(){return this.z?"x="+this.x+",y="+this.y+",z="+this.z:"x="+this.x+",y="+this.y},this.toShortString=function(){return this.z?this.x+","+this.y+","+this.z:this.x+","+this.y}}Point.fromMGRS=function(mgrsStr){return new Point(mgrs.toPoint(mgrsStr))},Point.prototype.toMGRS=function(accuracy){return mgrs.forward([this.x,this.y],accuracy)},module.exports=Point},{mgrs:108}],43:[function(_dereq_,module,exports){var parseCode=_dereq_("./parseCode"),extend=_dereq_("./extend"),projections=_dereq_("./projections"),deriveConstants=_dereq_("./deriveConstants");function Projection(srsCode,callback){if(!(this instanceof Projection))return new Projection(srsCode);callback=callback||function(error){if(error)throw error};var json=parseCode(srsCode);if("object"==typeof json){var modifiedJSON=deriveConstants(json),ourProj=Projection.projections.get(modifiedJSON.projName);ourProj?(extend(this,modifiedJSON),extend(this,ourProj),this.init(),callback(null,this)):callback(srsCode)}else callback(srsCode)}Projection.projections=projections,Projection.projections.start(),module.exports=Projection},{"./deriveConstants":72,"./extend":73,"./parseCode":77,"./projections":79}],44:[function(_dereq_,module,exports){module.exports=function(crs,denorm,point){var xin=point.x,yin=point.y,zin=point.z||0,v,t,i;for(i=0;i<3;i++)if(!denorm||2!==i||void 0!==point.z)switch(0===i?(v=xin,t="x"):1===i?(v=yin,t="y"):(v=zin,t="z"),crs.axis[i]){case"e":point[t]=v;break;case"w":point[t]=-v;break;case"n":point[t]=v;break;case"s":point[t]=-v;break;case"u":void 0!==point[t]&&(point.z=v);break;case"d":void 0!==point[t]&&(point.z=-v);break;default:return null}return point}},{}],45:[function(_dereq_,module,exports){var HALF_PI=Math.PI/2,sign=_dereq_("./sign");module.exports=function(x){return Math.abs(x)<HALF_PI?x:x-sign(x)*Math.PI}},{"./sign":62}],46:[function(_dereq_,module,exports){var TWO_PI=2*Math.PI,sign=_dereq_("./sign");module.exports=function(x){return Math.abs(x)<Math.PI?x:x-sign(x)*TWO_PI}},{"./sign":62}],47:[function(_dereq_,module,exports){module.exports=function(x){return Math.abs(x)>1&&(x=x>1?1:-1),Math.asin(x)}},{}],48:[function(_dereq_,module,exports){module.exports=function(x){return 1-.25*x*(1+x/16*(3+1.25*x))}},{}],49:[function(_dereq_,module,exports){module.exports=function(x){return.375*x*(1+.25*x*(1+.46875*x))}},{}],50:[function(_dereq_,module,exports){module.exports=function(x){return.05859375*x*x*(1+.75*x)}},{}],51:[function(_dereq_,module,exports){module.exports=function(x){return x*x*x*(35/3072)}},{}],52:[function(_dereq_,module,exports){module.exports=function(a,e,sinphi){var temp=e*sinphi;return a/Math.sqrt(1-temp*temp)}},{}],53:[function(_dereq_,module,exports){module.exports=function(ml,e0,e1,e2,e3){var phi,dphi;phi=ml/e0;for(var i=0;i<15;i++)if(phi+=dphi=(ml-(e0*phi-e1*Math.sin(2*phi)+e2*Math.sin(4*phi)-e3*Math.sin(6*phi)))/(e0-2*e1*Math.cos(2*phi)+4*e2*Math.cos(4*phi)-6*e3*Math.cos(6*phi)),Math.abs(dphi)<=1e-10)return phi;return NaN}},{}],54:[function(_dereq_,module,exports){var HALF_PI=Math.PI/2;module.exports=function(eccent,q){var temp=1-(1-eccent*eccent)/(2*eccent)*Math.log((1-eccent)/(1+eccent));if(Math.abs(Math.abs(q)-temp)<1e-6)return q<0?-1*HALF_PI:HALF_PI;for(var phi=Math.asin(.5*q),dphi,sin_phi,cos_phi,con,i=0;i<30;i++)if(sin_phi=Math.sin(phi),cos_phi=Math.cos(phi),con=eccent*sin_phi,phi+=dphi=Math.pow(1-con*con,2)/(2*cos_phi)*(q/(1-eccent*eccent)-sin_phi/(1-con*con)+.5/eccent*Math.log((1-con)/(1+con))),Math.abs(dphi)<=1e-10)return phi;return NaN}},{}],55:[function(_dereq_,module,exports){module.exports=function(e0,e1,e2,e3,phi){return e0*phi-e1*Math.sin(2*phi)+e2*Math.sin(4*phi)-e3*Math.sin(6*phi)}},{}],56:[function(_dereq_,module,exports){module.exports=function(eccent,sinphi,cosphi){var con=eccent*sinphi;return cosphi/Math.sqrt(1-con*con)}},{}],57:[function(_dereq_,module,exports){var HALF_PI=Math.PI/2;module.exports=function(eccent,ts){for(var eccnth=.5*eccent,con,dphi,phi=HALF_PI-2*Math.atan(ts),i=0;i<=15;i++)if(con=eccent*Math.sin(phi),phi+=dphi=HALF_PI-2*Math.atan(ts*Math.pow((1-con)/(1+con),eccnth))-phi,Math.abs(dphi)<=1e-10)return phi;return-9999}},{}],58:[function(_dereq_,module,exports){var C00=1,C02=.25,C04=.046875,C06=.01953125,C08=.01068115234375,C22=.75,C44=.46875,C46=.013020833333333334,C48=.007120768229166667,C66=.3645833333333333,C68=.005696614583333333,C88=.3076171875;module.exports=function(es){var en=[];en[0]=1-es*(.25+es*(C04+es*(C06+es*C08))),en[1]=es*(.75-es*(C04+es*(C06+es*C08)));var t=es*es;return en[2]=t*(C44-es*(C46+es*C48)),t*=es,en[3]=t*(C66-es*C68),en[4]=t*es*C88,en}},{}],59:[function(_dereq_,module,exports){var pj_mlfn=_dereq_("./pj_mlfn"),EPSLN=1e-10,MAX_ITER=20;module.exports=function(arg,es,en){for(var k=1/(1-es),phi=arg,i=20;i;--i){var s=Math.sin(phi),t=1-es*s*s;if(phi-=t=(pj_mlfn(phi,s,Math.cos(phi),en)-arg)*(t*Math.sqrt(t))*k,Math.abs(t)<1e-10)return phi}return phi}},{"./pj_mlfn":60}],60:[function(_dereq_,module,exports){module.exports=function(phi,sphi,cphi,en){return cphi*=sphi,sphi*=sphi,en[0]*phi-cphi*(en[1]+sphi*(en[2]+sphi*(en[3]+sphi*en[4])))}},{}],61:[function(_dereq_,module,exports){module.exports=function(eccent,sinphi){var con;return eccent>1e-7?(1-eccent*eccent)*(sinphi/(1-(con=eccent*sinphi)*con)-.5/eccent*Math.log((1-con)/(1+con))):2*sinphi}},{}],62:[function(_dereq_,module,exports){module.exports=function(x){return x<0?-1:1}},{}],63:[function(_dereq_,module,exports){module.exports=function(esinp,exp){return Math.pow((1-esinp)/(1+esinp),exp)}},{}],64:[function(_dereq_,module,exports){var HALF_PI=Math.PI/2;module.exports=function(eccent,phi,sinphi){var con=eccent*sinphi,com=.5*eccent;return con=Math.pow((1-con)/(1+con),com),Math.tan(.5*(HALF_PI-phi))/con}},{}],65:[function(_dereq_,module,exports){exports.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},exports.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},exports.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},exports.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},exports.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},exports.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},exports.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},exports.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},exports.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},exports.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},exports.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},exports.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},exports.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},exports.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},exports.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"}},{}],66:[function(_dereq_,module,exports){exports.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},exports.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},exports.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},exports.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},exports.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},exports.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},exports.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},exports.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},exports.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},exports.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},exports.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},exports.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},exports.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},exports.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},exports.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},exports.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},exports.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},exports.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},exports.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},exports.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},exports.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},exports.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},exports.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},exports.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},exports.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},exports.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},exports.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},exports.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},exports.hough={a:6378270,rf:297,ellipseName:"Hough"},exports.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},exports.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},exports.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},exports.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},exports.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},exports.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},exports.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},exports.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},exports.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},exports.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},exports.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},exports.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},exports.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},exports.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],67:[function(_dereq_,module,exports){exports.greenwich=0,exports.lisbon=-9.131906111111,exports.paris=2.337229166667,exports.bogota=-74.080916666667,exports.madrid=-3.687938888889,exports.rome=12.452333333333,exports.bern=7.439583333333,exports.jakarta=106.807719444444,exports.ferro=-17.666666666667,exports.brussels=4.367975,exports.stockholm=18.058277777778,exports.athens=23.7163375,exports.oslo=10.722916666667},{}],68:[function(_dereq_,module,exports){var point=_dereq_("./Point"),proj=_dereq_("./Proj"),transform=_dereq_("./transform"),wgs84=proj("WGS84");function transformer(from,to,coords){var transformedArray;return Array.isArray(coords)?(transformedArray=transform(from,to,point(coords)),3===coords.length?[transformedArray.x,transformedArray.y,transformedArray.z]:[transformedArray.x,transformedArray.y]):transform(from,to,coords)}function checkProj(item){return item instanceof proj?item:item.oProj?item.oProj:proj(item)}function proj4(fromProj,toProj,coord){fromProj=checkProj(fromProj);var single=!1,obj;return void 0===toProj?(toProj=fromProj,fromProj=wgs84,single=!0):(void 0!==toProj.x||Array.isArray(toProj))&&(coord=toProj,toProj=fromProj,fromProj=wgs84,single=!0),toProj=checkProj(toProj),coord?transformer(fromProj,toProj,coord):(obj={forward:function(coords){return transformer(fromProj,toProj,coords)},inverse:function(coords){return transformer(toProj,fromProj,coords)}},single&&(obj.oProj=toProj),obj)}module.exports=proj4},{"./Point":42,"./Proj":43,"./transform":105}],69:[function(_dereq_,module,exports){var HALF_PI=Math.PI/2,PJD_3PARAM=1,PJD_7PARAM=2,PJD_GRIDSHIFT=3,PJD_WGS84=4,PJD_NODATUM=5,SEC_TO_RAD=484813681109536e-20,AD_C=1.0026,COS_67P5=.3826834323650898,datum=function(proj){if(!(this instanceof datum))return new datum(proj);if(this.datum_type=4,proj){if(proj.datumCode&&"none"===proj.datumCode&&(this.datum_type=5),proj.datum_params){for(var i=0;i<proj.datum_params.length;i++)proj.datum_params[i]=parseFloat(proj.datum_params[i]);0===proj.datum_params[0]&&0===proj.datum_params[1]&&0===proj.datum_params[2]||(this.datum_type=1),proj.datum_params.length>3&&(0===proj.datum_params[3]&&0===proj.datum_params[4]&&0===proj.datum_params[5]&&0===proj.datum_params[6]||(this.datum_type=2,proj.datum_params[3]*=SEC_TO_RAD,proj.datum_params[4]*=SEC_TO_RAD,proj.datum_params[5]*=SEC_TO_RAD,proj.datum_params[6]=proj.datum_params[6]/1e6+1))}this.datum_type=proj.grids?3:this.datum_type,this.a=proj.a,this.b=proj.b,this.es=proj.es,this.ep2=proj.ep2,this.datum_params=proj.datum_params,3===this.datum_type&&(this.grids=proj.grids)}};datum.prototype={compare_datums:function(dest){return this.datum_type===dest.datum_type&&(!(this.a!==dest.a||Math.abs(this.es-dest.es)>5e-11)&&(1===this.datum_type?this.datum_params[0]===dest.datum_params[0]&&this.datum_params[1]===dest.datum_params[1]&&this.datum_params[2]===dest.datum_params[2]:2===this.datum_type?this.datum_params[0]===dest.datum_params[0]&&this.datum_params[1]===dest.datum_params[1]&&this.datum_params[2]===dest.datum_params[2]&&this.datum_params[3]===dest.datum_params[3]&&this.datum_params[4]===dest.datum_params[4]&&this.datum_params[5]===dest.datum_params[5]&&this.datum_params[6]===dest.datum_params[6]:3!==this.datum_type&&3!==dest.datum_type||this.nadgrids===dest.nadgrids))},geodetic_to_geocentric:function(p){var Longitude=p.x,Latitude=p.y,Height=p.z?p.z:0,X,Y,Z,Error_Code=0,Rn,Sin_Lat,Sin2_Lat,Cos_Lat;if(Latitude<-HALF_PI&&Latitude>-1.001*HALF_PI)Latitude=-HALF_PI;else if(Latitude>HALF_PI&&Latitude<1.001*HALF_PI)Latitude=HALF_PI;else if(Latitude<-HALF_PI||Latitude>HALF_PI)return null;return Longitude>Math.PI&&(Longitude-=2*Math.PI),Sin_Lat=Math.sin(Latitude),Cos_Lat=Math.cos(Latitude),Sin2_Lat=Sin_Lat*Sin_Lat,X=((Rn=this.a/Math.sqrt(1-this.es*Sin2_Lat))+Height)*Cos_Lat*Math.cos(Longitude),Y=(Rn+Height)*Cos_Lat*Math.sin(Longitude),Z=(Rn*(1-this.es)+Height)*Sin_Lat,p.x=X,p.y=Y,p.z=Z,0},geocentric_to_geodetic:function(p){var genau=1e-12,genau2=1e-24,maxiter=30,P,RR,CT,ST,RX,RK,RN,CPHI0,SPHI0,CPHI,SPHI,SDPHI,At_Pole,iter,X=p.x,Y=p.y,Z=p.z?p.z:0,Longitude,Latitude,Height;if(At_Pole=!1,P=Math.sqrt(X*X+Y*Y),RR=Math.sqrt(X*X+Y*Y+Z*Z),P/this.a<1e-12){if(At_Pole=!0,Longitude=0,RR/this.a<1e-12)return Latitude=HALF_PI,void(Height=-this.b)}else Longitude=Math.atan2(Y,X);CT=Z/RR,ST=P/RR,RX=1/Math.sqrt(1-this.es*(2-this.es)*ST*ST),CPHI0=ST*(1-this.es)*RX,SPHI0=CT*RX,iter=0;do{iter++,Height=P*CPHI0+Z*SPHI0-(RN=this.a/Math.sqrt(1-this.es*SPHI0*SPHI0))*(1-this.es*SPHI0*SPHI0),RK=this.es*RN/(RN+Height),SDPHI=(SPHI=CT*(RX=1/Math.sqrt(1-RK*(2-RK)*ST*ST)))*CPHI0-(CPHI=ST*(1-RK)*RX)*SPHI0,CPHI0=CPHI,SPHI0=SPHI}while(SDPHI*SDPHI>1e-24&&iter<30);return Latitude=Math.atan(SPHI/Math.abs(CPHI)),p.x=Longitude,p.y=Latitude,p.z=Height,p},geocentric_to_geodetic_noniter:function(p){var X=p.x,Y=p.y,Z=p.z?p.z:0,Longitude,Latitude,Height,W,W2,T0,T1,S0,S1,Sin_B0,Sin3_B0,Cos_B0,Sin_p1,Cos_p1,Rn,Sum,At_Pole;if(X=parseFloat(X),Y=parseFloat(Y),Z=parseFloat(Z),At_Pole=!1,0!==X)Longitude=Math.atan2(Y,X);else if(Y>0)Longitude=HALF_PI;else if(Y<0)Longitude=-HALF_PI;else if(At_Pole=!0,Longitude=0,Z>0)Latitude=HALF_PI;else{if(!(Z<0))return Latitude=HALF_PI,void(Height=-this.b);Latitude=-HALF_PI}return W2=X*X+Y*Y,W=Math.sqrt(W2),T0=Z*AD_C,Cos_B0=W/(S0=Math.sqrt(T0*T0+W2)),Sin3_B0=(Sin_B0=T0/S0)*Sin_B0*Sin_B0,T1=Z+this.b*this.ep2*Sin3_B0,Sum=W-this.a*this.es*Cos_B0*Cos_B0*Cos_B0,Sin_p1=T1/(S1=Math.sqrt(T1*T1+Sum*Sum)),Cos_p1=Sum/S1,Rn=this.a/Math.sqrt(1-this.es*Sin_p1*Sin_p1),Height=Cos_p1>=COS_67P5?W/Cos_p1-Rn:Cos_p1<=-COS_67P5?W/-Cos_p1-Rn:Z/Sin_p1+Rn*(this.es-1),!1===At_Pole&&(Latitude=Math.atan(Sin_p1/Cos_p1)),p.x=Longitude,p.y=Latitude,p.z=Height,p},geocentric_to_wgs84:function(p){if(1===this.datum_type)p.x+=this.datum_params[0],p.y+=this.datum_params[1],p.z+=this.datum_params[2];else if(2===this.datum_type){var Dx_BF=this.datum_params[0],Dy_BF=this.datum_params[1],Dz_BF=this.datum_params[2],Rx_BF=this.datum_params[3],Ry_BF=this.datum_params[4],Rz_BF=this.datum_params[5],M_BF=this.datum_params[6],x_out=M_BF*(p.x-Rz_BF*p.y+Ry_BF*p.z)+Dx_BF,y_out=M_BF*(Rz_BF*p.x+p.y-Rx_BF*p.z)+Dy_BF,z_out=M_BF*(-Ry_BF*p.x+Rx_BF*p.y+p.z)+Dz_BF;p.x=x_out,p.y=y_out,p.z=z_out}},geocentric_from_wgs84:function(p){if(1===this.datum_type)p.x-=this.datum_params[0],p.y-=this.datum_params[1],p.z-=this.datum_params[2];else if(2===this.datum_type){var Dx_BF=this.datum_params[0],Dy_BF=this.datum_params[1],Dz_BF=this.datum_params[2],Rx_BF=this.datum_params[3],Ry_BF=this.datum_params[4],Rz_BF=this.datum_params[5],M_BF=this.datum_params[6],x_tmp=(p.x-Dx_BF)/M_BF,y_tmp=(p.y-Dy_BF)/M_BF,z_tmp=(p.z-Dz_BF)/M_BF;p.x=x_tmp+Rz_BF*y_tmp-Ry_BF*z_tmp,p.y=-Rz_BF*x_tmp+y_tmp+Rx_BF*z_tmp,p.z=Ry_BF*x_tmp-Rx_BF*y_tmp+z_tmp}}},module.exports=datum},{}],70:[function(_dereq_,module,exports){var PJD_3PARAM=1,PJD_7PARAM=2,PJD_GRIDSHIFT=3,PJD_NODATUM=5,SRS_WGS84_SEMIMAJOR=6378137,SRS_WGS84_ESQUARED=.006694379990141316;module.exports=function(source,dest,point){var wp,i,l;function checkParams(fallback){return fallback===PJD_3PARAM||fallback===PJD_7PARAM}if(source.compare_datums(dest))return point;if(5===source.datum_type||5===dest.datum_type)return point;var src_a=source.a,src_es=source.es,dst_a=dest.a,dst_es=dest.es,fallback=source.datum_type;if(3===fallback)if(0===this.apply_gridshift(source,0,point))source.a=6378137,source.es=SRS_WGS84_ESQUARED;else{if(!source.datum_params)return source.a=src_a,source.es=source.es,point;for(wp=1,i=0,l=source.datum_params.length;i<l;i++)wp*=source.datum_params[i];if(0===wp)return source.a=src_a,source.es=source.es,point;fallback=source.datum_params.length>3?PJD_7PARAM:PJD_3PARAM}return 3===dest.datum_type&&(dest.a=6378137,dest.es=SRS_WGS84_ESQUARED),(source.es!==dest.es||source.a!==dest.a||checkParams(fallback)||checkParams(dest.datum_type))&&(source.geodetic_to_geocentric(point),checkParams(source.datum_type)&&source.geocentric_to_wgs84(point),checkParams(dest.datum_type)&&dest.geocentric_from_wgs84(point),dest.geocentric_to_geodetic(point)),3===dest.datum_type&&this.apply_gridshift(dest,1,point),source.a=src_a,source.es=src_es,dest.a=dst_a,dest.es=dst_es,point}},{}],71:[function(_dereq_,module,exports){var globals=_dereq_("./global"),parseProj=_dereq_("./projString"),wkt=_dereq_("./wkt");function defs(name){var that=this;if(2===arguments.length)"+"===arguments[1][0]?defs[name]=parseProj(arguments[1]):defs[name]=wkt(arguments[1]);else if(1===arguments.length)return Array.isArray(name)?name.map((function(v){Array.isArray(v)?defs.apply(that,v):defs(v)})):void("string"==typeof name||("EPSG"in name?defs["EPSG:"+name.EPSG]=name:"ESRI"in name?defs["ESRI:"+name.ESRI]=name:"IAU2000"in name?defs["IAU2000:"+name.IAU2000]=name:console.log(name)))}globals(defs),module.exports=defs},{"./global":74,"./projString":78,"./wkt":107}],72:[function(_dereq_,module,exports){var Datum=_dereq_("./constants/Datum"),Ellipsoid=_dereq_("./constants/Ellipsoid"),extend=_dereq_("./extend"),datum=_dereq_("./datum"),EPSLN=1e-10,SIXTH=.16666666666666666,RA4=.04722222222222222,RA6=.022156084656084655;module.exports=function(json){if(json.datumCode&&"none"!==json.datumCode){var datumDef=Datum[json.datumCode];datumDef&&(json.datum_params=datumDef.towgs84?datumDef.towgs84.split(","):null,json.ellps=datumDef.ellipse,json.datumName=datumDef.datumName?datumDef.datumName:json.datumCode)}if(!json.a){var ellipse=Ellipsoid[json.ellps]?Ellipsoid[json.ellps]:Ellipsoid.WGS84;extend(json,ellipse)}return json.rf&&!json.b&&(json.b=(1-1/json.rf)*json.a),(0===json.rf||Math.abs(json.a-json.b)<1e-10)&&(json.sphere=!0,json.b=json.a),json.a2=json.a*json.a,json.b2=json.b*json.b,json.es=(json.a2-json.b2)/json.a2,json.e=Math.sqrt(json.es),json.R_A&&(json.a*=1-json.es*(SIXTH+json.es*(RA4+json.es*RA6)),json.a2=json.a*json.a,json.b2=json.b*json.b,json.es=0),json.ep2=(json.a2-json.b2)/json.b2,json.k0||(json.k0=1),json.axis||(json.axis="enu"),json.datum=datum(json),json}},{"./constants/Datum":65,"./constants/Ellipsoid":66,"./datum":69,"./extend":73}],73:[function(_dereq_,module,exports){module.exports=function(destination,source){var value,property;if(destination=destination||{},!source)return destination;for(property in source)void 0!==(value=source[property])&&(destination[property]=value);return destination}},{}],74:[function(_dereq_,module,exports){module.exports=function(defs){defs("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),defs("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),defs("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),defs("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),defs["EPSG:3785"]=defs["EPSG:3857"],defs.GOOGLE=defs["EPSG:3857"],defs["EPSG:900913"]=defs["EPSG:3857"],defs["EPSG:102113"]=defs["EPSG:3857"]}},{}],75:[function(_dereq_,module,exports){var projs=[_dereq_("./projections/tmerc"),_dereq_("./projections/utm"),_dereq_("./projections/sterea"),_dereq_("./projections/stere"),_dereq_("./projections/somerc"),_dereq_("./projections/omerc"),_dereq_("./projections/lcc"),_dereq_("./projections/krovak"),_dereq_("./projections/cass"),_dereq_("./projections/laea"),_dereq_("./projections/aea"),_dereq_("./projections/gnom"),_dereq_("./projections/cea"),_dereq_("./projections/eqc"),_dereq_("./projections/poly"),_dereq_("./projections/nzmg"),_dereq_("./projections/mill"),_dereq_("./projections/sinu"),_dereq_("./projections/moll"),_dereq_("./projections/eqdc"),_dereq_("./projections/vandg"),_dereq_("./projections/aeqd")];module.exports=function(proj4){projs.forEach((function(proj){proj4.Proj.projections.add(proj)}))}},{"./projections/aea":80,"./projections/aeqd":81,"./projections/cass":82,"./projections/cea":83,"./projections/eqc":84,"./projections/eqdc":85,"./projections/gnom":87,"./projections/krovak":88,"./projections/laea":89,"./projections/lcc":90,"./projections/mill":93,"./projections/moll":94,"./projections/nzmg":95,"./projections/omerc":96,"./projections/poly":97,"./projections/sinu":98,"./projections/somerc":99,"./projections/stere":100,"./projections/sterea":101,"./projections/tmerc":102,"./projections/utm":103,"./projections/vandg":104}],76:[function(_dereq_,module,exports){var proj4=_dereq_("./core");proj4.defaultDatum="WGS84",proj4.Proj=_dereq_("./Proj"),proj4.WGS84=new proj4.Proj("WGS84"),proj4.Point=_dereq_("./Point"),proj4.defs=_dereq_("./defs"),proj4.transform=_dereq_("./transform"),proj4.mgrs=_dereq_("mgrs"),proj4.version=_dereq_("./version"),_dereq_("./includedProjections")(proj4),module.exports=proj4},{"./Point":42,"./Proj":43,"./core":68,"./defs":71,"./includedProjections":75,"./transform":105,"./version":106,mgrs:108}],77:[function(_dereq_,module,exports){var defs=_dereq_("./defs"),wkt=_dereq_("./wkt"),projStr=_dereq_("./projString");function testObj(code){return"string"==typeof code}function testDef(code){return code in defs}function testWKT(code){var codeWords;return["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"].reduce((function(a,b){return a+1+code.indexOf(b)}),0)}function testProj(code){return"+"===code[0]}function parse(code){return testObj(code)?testDef(code)?defs[code]:testWKT(code)?wkt(code):testProj(code)?projStr(code):void 0:code}module.exports=parse},{"./defs":71,"./projString":78,"./wkt":107}],78:[function(_dereq_,module,exports){var D2R=.017453292519943295,PrimeMeridian=_dereq_("./constants/PrimeMeridian");module.exports=function(defData){var self={},paramObj={},paramName,paramVal,paramOutname;defData.split("+").map((function(v){return v.trim()})).filter((function(a){return a})).forEach((function(a){var split=a.split("=");split.push(!0),paramObj[split[0].toLowerCase()]=split[1]}));var params={proj:"projName",datum:"datumCode",rf:function(v){self.rf=parseFloat(v,10)},lat_0:function(v){self.lat0=v*D2R},lat_1:function(v){self.lat1=v*D2R},lat_2:function(v){self.lat2=v*D2R},lat_ts:function(v){self.lat_ts=v*D2R},lon_0:function(v){self.long0=v*D2R},lon_1:function(v){self.long1=v*D2R},lon_2:function(v){self.long2=v*D2R},alpha:function(v){self.alpha=parseFloat(v)*D2R},lonc:function(v){self.longc=v*D2R},x_0:function(v){self.x0=parseFloat(v,10)},y_0:function(v){self.y0=parseFloat(v,10)},k_0:function(v){self.k0=parseFloat(v,10)},k:function(v){self.k0=parseFloat(v,10)},r_a:function(){self.R_A=!0},zone:function(v){self.zone=parseInt(v,10)},south:function(){self.utmSouth=!0},towgs84:function(v){self.datum_params=v.split(",").map((function(a){return parseFloat(a,10)}))},to_meter:function(v){self.to_meter=parseFloat(v,10)},from_greenwich:function(v){self.from_greenwich=v*D2R},pm:function(v){self.from_greenwich=(PrimeMeridian[v]?PrimeMeridian[v]:parseFloat(v,10))*D2R},nadgrids:function(v){"@null"===v?self.datumCode="none":self.nadgrids=v},axis:function(v){var legalAxis="ewnsud";3===v.length&&-1!=="ewnsud".indexOf(v.substr(0,1))&&-1!=="ewnsud".indexOf(v.substr(1,1))&&-1!=="ewnsud".indexOf(v.substr(2,1))&&(self.axis=v)}};for(paramName in paramObj)paramVal=paramObj[paramName],paramName in params?"function"==typeof(paramOutname=params[paramName])?paramOutname(paramVal):self[paramOutname]=paramVal:self[paramName]=paramVal;return self}},{"./constants/PrimeMeridian":67}],79:[function(_dereq_,module,exports){var projs=[_dereq_("./projections/merc"),_dereq_("./projections/longlat")],names={},projStore=[];function add(proj,i){var len=projStore.length;return proj.names?(projStore[len]=proj,proj.names.forEach((function(n){names[n.toLowerCase()]=len})),this):(console.log(i),!0)}exports.add=add,exports.get=function(name){if(!name)return!1;var n=name.toLowerCase();return void 0!==names[n]&&projStore[names[n]]?projStore[names[n]]:void 0},exports.start=function(){projs.forEach(add)}},{"./projections/longlat":91,"./projections/merc":92}],80:[function(_dereq_,module,exports){var EPSLN=1e-10,msfnz=_dereq_("../common/msfnz"),qsfnz=_dereq_("../common/qsfnz"),adjust_lon=_dereq_("../common/adjust_lon"),asinz=_dereq_("../common/asinz");exports.init=function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=msfnz(this.e3,this.sin_po,this.cos_po),this.qs1=qsfnz(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=msfnz(this.e3,this.sin_po,this.cos_po),this.qs2=qsfnz(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=qsfnz(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>1e-10?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},exports.forward=function(p){var lon=p.x,lat=p.y;this.sin_phi=Math.sin(lat),this.cos_phi=Math.cos(lat);var qs=qsfnz(this.e3,this.sin_phi,this.cos_phi),rh1=this.a*Math.sqrt(this.c-this.ns0*qs)/this.ns0,theta=this.ns0*adjust_lon(lon-this.long0),x=rh1*Math.sin(theta)+this.x0,y=this.rh-rh1*Math.cos(theta)+this.y0;return p.x=x,p.y=y,p},exports.inverse=function(p){var rh1,qs,con,theta,lon,lat;return p.x-=this.x0,p.y=this.rh-p.y+this.y0,this.ns0>=0?(rh1=Math.sqrt(p.x*p.x+p.y*p.y),con=1):(rh1=-Math.sqrt(p.x*p.x+p.y*p.y),con=-1),theta=0,0!==rh1&&(theta=Math.atan2(con*p.x,con*p.y)),con=rh1*this.ns0/this.a,this.sphere?lat=Math.asin((this.c-con*con)/(2*this.ns0)):(qs=(this.c-con*con)/this.ns0,lat=this.phi1z(this.e3,qs)),lon=adjust_lon(theta/this.ns0+this.long0),p.x=lon,p.y=lat,p},exports.phi1z=function(eccent,qs){var sinphi,cosphi,con,com,dphi,phi=asinz(.5*qs);if(eccent<1e-10)return phi;for(var eccnts=eccent*eccent,i=1;i<=25;i++)if(phi+=dphi=.5*(com=1-(con=eccent*(sinphi=Math.sin(phi)))*con)*com/(cosphi=Math.cos(phi))*(qs/(1-eccnts)-sinphi/com+.5/eccent*Math.log((1-con)/(1+con))),Math.abs(dphi)<=1e-7)return phi;return null},exports.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":46,"../common/asinz":47,"../common/msfnz":56,"../common/qsfnz":61}],81:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon"),HALF_PI=Math.PI/2,EPSLN=1e-10,mlfn=_dereq_("../common/mlfn"),e0fn=_dereq_("../common/e0fn"),e1fn=_dereq_("../common/e1fn"),e2fn=_dereq_("../common/e2fn"),e3fn=_dereq_("../common/e3fn"),gN=_dereq_("../common/gN"),asinz=_dereq_("../common/asinz"),imlfn=_dereq_("../common/imlfn");exports.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},exports.forward=function(p){var lon=p.x,lat=p.y,sinphi=Math.sin(p.y),cosphi=Math.cos(p.y),dlon=adjust_lon(lon-this.long0),e0,e1,e2,e3,Mlp,Ml,tanphi,Nl1,Nl,psi,Az,G,H,GH,Hs,c,kp,cos_c,s,s2,s3,s4,s5;return this.sphere?Math.abs(this.sin_p12-1)<=1e-10?(p.x=this.x0+this.a*(HALF_PI-lat)*Math.sin(dlon),p.y=this.y0-this.a*(HALF_PI-lat)*Math.cos(dlon),p):Math.abs(this.sin_p12+1)<=1e-10?(p.x=this.x0+this.a*(HALF_PI+lat)*Math.sin(dlon),p.y=this.y0+this.a*(HALF_PI+lat)*Math.cos(dlon),p):(cos_c=this.sin_p12*sinphi+this.cos_p12*cosphi*Math.cos(dlon),kp=(c=Math.acos(cos_c))/Math.sin(c),p.x=this.x0+this.a*kp*cosphi*Math.sin(dlon),p.y=this.y0+this.a*kp*(this.cos_p12*sinphi-this.sin_p12*cosphi*Math.cos(dlon)),p):(e0=e0fn(this.es),e1=e1fn(this.es),e2=e2fn(this.es),e3=e3fn(this.es),Math.abs(this.sin_p12-1)<=1e-10?(Mlp=this.a*mlfn(e0,e1,e2,e3,HALF_PI),Ml=this.a*mlfn(e0,e1,e2,e3,lat),p.x=this.x0+(Mlp-Ml)*Math.sin(dlon),p.y=this.y0-(Mlp-Ml)*Math.cos(dlon),p):Math.abs(this.sin_p12+1)<=1e-10?(Mlp=this.a*mlfn(e0,e1,e2,e3,HALF_PI),Ml=this.a*mlfn(e0,e1,e2,e3,lat),p.x=this.x0+(Mlp+Ml)*Math.sin(dlon),p.y=this.y0+(Mlp+Ml)*Math.cos(dlon),p):(tanphi=sinphi/cosphi,Nl1=gN(this.a,this.e,this.sin_p12),Nl=gN(this.a,this.e,sinphi),psi=Math.atan((1-this.es)*tanphi+this.es*Nl1*this.sin_p12/(Nl*cosphi)),s=0===(Az=Math.atan2(Math.sin(dlon),this.cos_p12*Math.tan(psi)-this.sin_p12*Math.cos(dlon)))?Math.asin(this.cos_p12*Math.sin(psi)-this.sin_p12*Math.cos(psi)):Math.abs(Math.abs(Az)-Math.PI)<=1e-10?-Math.asin(this.cos_p12*Math.sin(psi)-this.sin_p12*Math.cos(psi)):Math.asin(Math.sin(dlon)*Math.cos(psi)/Math.sin(Az)),G=this.e*this.sin_p12/Math.sqrt(1-this.es),c=Nl1*s*(1-(s2=s*s)*(Hs=(H=this.e*this.cos_p12*Math.cos(Az)/Math.sqrt(1-this.es))*H)*(1-Hs)/6+(s3=s2*s)/8*(GH=G*H)*(1-2*Hs)+(s4=s3*s)/120*(Hs*(4-7*Hs)-3*G*G*(1-7*Hs))-(s5=s4*s)/48*GH),p.x=this.x0+c*Math.sin(Az),p.y=this.y0+c*Math.cos(Az),p))},exports.inverse=function(p){var rh,z,sinz,cosz,lon,lat,con,e0,e1,e2,e3,Mlp,M,N1,psi,Az,cosAz,tmp,A,B,D,Ee,F;if(p.x-=this.x0,p.y-=this.y0,this.sphere){if((rh=Math.sqrt(p.x*p.x+p.y*p.y))>2*HALF_PI*this.a)return;return z=rh/this.a,sinz=Math.sin(z),cosz=Math.cos(z),lon=this.long0,Math.abs(rh)<=1e-10?lat=this.lat0:(lat=asinz(cosz*this.sin_p12+p.y*sinz*this.cos_p12/rh),con=Math.abs(this.lat0)-HALF_PI,lon=Math.abs(con)<=1e-10?this.lat0>=0?adjust_lon(this.long0+Math.atan2(p.x,-p.y)):adjust_lon(this.long0-Math.atan2(-p.x,p.y)):adjust_lon(this.long0+Math.atan2(p.x*sinz,rh*this.cos_p12*cosz-p.y*this.sin_p12*sinz))),p.x=lon,p.y=lat,p}return e0=e0fn(this.es),e1=e1fn(this.es),e2=e2fn(this.es),e3=e3fn(this.es),Math.abs(this.sin_p12-1)<=1e-10?(Mlp=this.a*mlfn(e0,e1,e2,e3,HALF_PI),rh=Math.sqrt(p.x*p.x+p.y*p.y),lat=imlfn((M=Mlp-rh)/this.a,e0,e1,e2,e3),lon=adjust_lon(this.long0+Math.atan2(p.x,-1*p.y)),p.x=lon,p.y=lat,p):Math.abs(this.sin_p12+1)<=1e-10?(Mlp=this.a*mlfn(e0,e1,e2,e3,HALF_PI),rh=Math.sqrt(p.x*p.x+p.y*p.y),lat=imlfn((M=rh-Mlp)/this.a,e0,e1,e2,e3),lon=adjust_lon(this.long0+Math.atan2(p.x,p.y)),p.x=lon,p.y=lat,p):(rh=Math.sqrt(p.x*p.x+p.y*p.y),Az=Math.atan2(p.x,p.y),N1=gN(this.a,this.e,this.sin_p12),cosAz=Math.cos(Az),A=-(tmp=this.e*this.cos_p12*cosAz)*tmp/(1-this.es),B=3*this.es*(1-A)*this.sin_p12*this.cos_p12*cosAz/(1-this.es),F=1-A*(Ee=(D=rh/N1)-A*(1+A)*Math.pow(D,3)/6-B*(1+3*A)*Math.pow(D,4)/24)*Ee/2-D*Ee*Ee*Ee/6,psi=Math.asin(this.sin_p12*Math.cos(Ee)+this.cos_p12*Math.sin(Ee)*cosAz),lon=adjust_lon(this.long0+Math.asin(Math.sin(Az)*Math.sin(Ee)/Math.cos(psi))),lat=Math.atan((1-this.es*F*this.sin_p12/Math.sin(psi))*Math.tan(psi)/(1-this.es)),p.x=lon,p.y=lat,p)},exports.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":46,"../common/asinz":47,"../common/e0fn":48,"../common/e1fn":49,"../common/e2fn":50,"../common/e3fn":51,"../common/gN":52,"../common/imlfn":53,"../common/mlfn":55}],82:[function(_dereq_,module,exports){var mlfn=_dereq_("../common/mlfn"),e0fn=_dereq_("../common/e0fn"),e1fn=_dereq_("../common/e1fn"),e2fn=_dereq_("../common/e2fn"),e3fn=_dereq_("../common/e3fn"),gN=_dereq_("../common/gN"),adjust_lon=_dereq_("../common/adjust_lon"),adjust_lat=_dereq_("../common/adjust_lat"),imlfn=_dereq_("../common/imlfn"),HALF_PI=Math.PI/2,EPSLN=1e-10;exports.init=function(){this.sphere||(this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.ml0=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0))},exports.forward=function(p){var x,y,lam=p.x,phi=p.y;if(lam=adjust_lon(lam-this.long0),this.sphere)x=this.a*Math.asin(Math.cos(phi)*Math.sin(lam)),y=this.a*(Math.atan2(Math.tan(phi),Math.cos(lam))-this.lat0);else{var sinphi=Math.sin(phi),cosphi=Math.cos(phi),nl=gN(this.a,this.e,sinphi),tl=Math.tan(phi)*Math.tan(phi),al=lam*Math.cos(phi),asq=al*al,cl=this.es*cosphi*cosphi/(1-this.es),ml;x=nl*al*(1-asq*tl*(1/6-(8-tl+8*cl)*asq/120)),y=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,phi)-this.ml0+nl*sinphi/cosphi*asq*(.5+(5-tl+6*cl)*asq/24)}return p.x=x+this.x0,p.y=y+this.y0,p},exports.inverse=function(p){p.x-=this.x0,p.y-=this.y0;var x=p.x/this.a,y=p.y/this.a,phi,lam;if(this.sphere){var dd=y+this.lat0;phi=Math.asin(Math.sin(dd)*Math.cos(x)),lam=Math.atan2(Math.tan(x),Math.cos(dd))}else{var ml1=this.ml0/this.a+y,phi1=imlfn(ml1,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(phi1)-HALF_PI)<=1e-10)return p.x=this.long0,p.y=HALF_PI,y<0&&(p.y*=-1),p;var nl1=gN(this.a,this.e,Math.sin(phi1)),rl1=nl1*nl1*nl1/this.a/this.a*(1-this.es),tl1=Math.pow(Math.tan(phi1),2),dl=x*this.a/nl1,dsq=dl*dl;phi=phi1-nl1*Math.tan(phi1)/rl1*dl*dl*(.5-(1+3*tl1)*dl*dl/24),lam=dl*(1-dsq*(tl1/3+(1+3*tl1)*tl1*dsq/15))/Math.cos(phi1)}return p.x=adjust_lon(lam+this.long0),p.y=adjust_lat(phi),p},exports.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":45,"../common/adjust_lon":46,"../common/e0fn":48,"../common/e1fn":49,"../common/e2fn":50,"../common/e3fn":51,"../common/gN":52,"../common/imlfn":53,"../common/mlfn":55}],83:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon"),qsfnz=_dereq_("../common/qsfnz"),msfnz=_dereq_("../common/msfnz"),iqsfnz=_dereq_("../common/iqsfnz");exports.init=function(){this.sphere||(this.k0=msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},exports.forward=function(p){var lon=p.x,lat=p.y,x,y,dlon=adjust_lon(lon-this.long0);if(this.sphere)x=this.x0+this.a*dlon*Math.cos(this.lat_ts),y=this.y0+this.a*Math.sin(lat)/Math.cos(this.lat_ts);else{var qs=qsfnz(this.e,Math.sin(lat));x=this.x0+this.a*this.k0*dlon,y=this.y0+this.a*qs*.5/this.k0}return p.x=x,p.y=y,p},exports.inverse=function(p){var lon,lat;return p.x-=this.x0,p.y-=this.y0,this.sphere?(lon=adjust_lon(this.long0+p.x/this.a/Math.cos(this.lat_ts)),lat=Math.asin(p.y/this.a*Math.cos(this.lat_ts))):(lat=iqsfnz(this.e,2*p.y*this.k0/this.a),lon=adjust_lon(this.long0+p.x/(this.a*this.k0))),p.x=lon,p.y=lat,p},exports.names=["cea"]},{"../common/adjust_lon":46,"../common/iqsfnz":54,"../common/msfnz":56,"../common/qsfnz":61}],84:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon"),adjust_lat=_dereq_("../common/adjust_lat");exports.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},exports.forward=function(p){var lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0),dlat=adjust_lat(lat-this.lat0);return p.x=this.x0+this.a*dlon*this.rc,p.y=this.y0+this.a*dlat,p},exports.inverse=function(p){var x=p.x,y=p.y;return p.x=adjust_lon(this.long0+(x-this.x0)/(this.a*this.rc)),p.y=adjust_lat(this.lat0+(y-this.y0)/this.a),p},exports.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":45,"../common/adjust_lon":46}],85:[function(_dereq_,module,exports){var e0fn=_dereq_("../common/e0fn"),e1fn=_dereq_("../common/e1fn"),e2fn=_dereq_("../common/e2fn"),e3fn=_dereq_("../common/e3fn"),msfnz=_dereq_("../common/msfnz"),mlfn=_dereq_("../common/mlfn"),adjust_lon=_dereq_("../common/adjust_lon"),adjust_lat=_dereq_("../common/adjust_lat"),imlfn=_dereq_("../common/imlfn"),EPSLN=1e-10;exports.init=function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=msfnz(this.e,this.sinphi,this.cosphi),this.ml1=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<1e-10?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=msfnz(this.e,this.sinphi,this.cosphi),this.ml2=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},exports.forward=function(p){var lon=p.x,lat=p.y,rh1;if(this.sphere)rh1=this.a*(this.g-lat);else{var ml=mlfn(this.e0,this.e1,this.e2,this.e3,lat);rh1=this.a*(this.g-ml)}var theta=this.ns*adjust_lon(lon-this.long0),x=this.x0+rh1*Math.sin(theta),y=this.y0+this.rh-rh1*Math.cos(theta);return p.x=x,p.y=y,p},exports.inverse=function(p){var con,rh1,lat,lon;p.x-=this.x0,p.y=this.rh-p.y+this.y0,this.ns>=0?(rh1=Math.sqrt(p.x*p.x+p.y*p.y),con=1):(rh1=-Math.sqrt(p.x*p.x+p.y*p.y),con=-1);var theta=0;if(0!==rh1&&(theta=Math.atan2(con*p.x,con*p.y)),this.sphere)return lon=adjust_lon(this.long0+theta/this.ns),lat=adjust_lat(this.g-rh1/this.a),p.x=lon,p.y=lat,p;var ml=this.g-rh1/this.a;return lat=imlfn(ml,this.e0,this.e1,this.e2,this.e3),lon=adjust_lon(this.long0+theta/this.ns),p.x=lon,p.y=lat,p},exports.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":45,"../common/adjust_lon":46,"../common/e0fn":48,"../common/e1fn":49,"../common/e2fn":50,"../common/e3fn":51,"../common/imlfn":53,"../common/mlfn":55,"../common/msfnz":56}],86:[function(_dereq_,module,exports){var FORTPI=Math.PI/4,srat=_dereq_("../common/srat"),HALF_PI=Math.PI/2,MAX_ITER=20;exports.init=function(){var sphi=Math.sin(this.lat0),cphi=Math.cos(this.lat0);cphi*=cphi,this.rc=Math.sqrt(1-this.es)/(1-this.es*sphi*sphi),this.C=Math.sqrt(1+this.es*cphi*cphi/(1-this.es)),this.phic0=Math.asin(sphi/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+FORTPI)/(Math.pow(Math.tan(.5*this.lat0+FORTPI),this.C)*srat(this.e*sphi,this.ratexp))},exports.forward=function(p){var lon=p.x,lat=p.y;return p.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*lat+FORTPI),this.C)*srat(this.e*Math.sin(lat),this.ratexp))-HALF_PI,p.x=this.C*lon,p},exports.inverse=function(p){for(var DEL_TOL=1e-14,lon=p.x/this.C,lat=p.y,num=Math.pow(Math.tan(.5*lat+FORTPI)/this.K,1/this.C),i=20;i>0&&(lat=2*Math.atan(num*srat(this.e*Math.sin(p.y),-.5*this.e))-HALF_PI,!(Math.abs(lat-p.y)<1e-14));--i)p.y=lat;return i?(p.x=lon,p.y=lat,p):null},exports.names=["gauss"]},{"../common/srat":63}],87:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon"),EPSLN=1e-10,asinz=_dereq_("../common/asinz");exports.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},exports.forward=function(p){var sinphi,cosphi,dlon,coslon,ksp,g,x,y,lon=p.x,lat=p.y;return dlon=adjust_lon(lon-this.long0),sinphi=Math.sin(lat),cosphi=Math.cos(lat),coslon=Math.cos(dlon),ksp=1,(g=this.sin_p14*sinphi+this.cos_p14*cosphi*coslon)>0||Math.abs(g)<=1e-10?(x=this.x0+1*this.a*cosphi*Math.sin(dlon)/g,y=this.y0+1*this.a*(this.cos_p14*sinphi-this.sin_p14*cosphi*coslon)/g):(x=this.x0+this.infinity_dist*cosphi*Math.sin(dlon),y=this.y0+this.infinity_dist*(this.cos_p14*sinphi-this.sin_p14*cosphi*coslon)),p.x=x,p.y=y,p},exports.inverse=function(p){var rh,sinc,cosc,c,lon,lat;return p.x=(p.x-this.x0)/this.a,p.y=(p.y-this.y0)/this.a,p.x/=this.k0,p.y/=this.k0,(rh=Math.sqrt(p.x*p.x+p.y*p.y))?(c=Math.atan2(rh,this.rc),sinc=Math.sin(c),cosc=Math.cos(c),lat=asinz(cosc*this.sin_p14+p.y*sinc*this.cos_p14/rh),lon=Math.atan2(p.x*sinc,rh*this.cos_p14*cosc-p.y*this.sin_p14*sinc),lon=adjust_lon(this.long0+lon)):(lat=this.phic0,lon=0),p.x=lon,p.y=lat,p},exports.names=["gnom"]},{"../common/adjust_lon":46,"../common/asinz":47}],88:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon");exports.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},exports.forward=function(p){var gfi,u,deltav,s,d,eps,ro,lon=p.x,lat=p.y,delta_lon=adjust_lon(lon-this.long0);return gfi=Math.pow((1+this.e*Math.sin(lat))/(1-this.e*Math.sin(lat)),this.alfa*this.e/2),u=2*(Math.atan(this.k*Math.pow(Math.tan(lat/2+this.s45),this.alfa)/gfi)-this.s45),deltav=-delta_lon*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(u)+Math.sin(this.ad)*Math.cos(u)*Math.cos(deltav)),d=Math.asin(Math.cos(u)*Math.sin(deltav)/Math.cos(s)),eps=this.n*d,ro=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),p.y=ro*Math.cos(eps)/1,p.x=ro*Math.sin(eps)/1,this.czech||(p.y*=-1,p.x*=-1),p},exports.inverse=function(p){var u,deltav,s,d,eps,ro,fi1,ok,tmp=p.x;p.x=p.y,p.y=tmp,this.czech||(p.y*=-1,p.x*=-1),ro=Math.sqrt(p.x*p.x+p.y*p.y),d=(eps=Math.atan2(p.y,p.x))/Math.sin(this.s0),s=2*(Math.atan(Math.pow(this.ro0/ro,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),u=Math.asin(Math.cos(this.ad)*Math.sin(s)-Math.sin(this.ad)*Math.cos(s)*Math.cos(d)),deltav=Math.asin(Math.cos(s)*Math.sin(d)/Math.cos(u)),p.x=this.long0-deltav/this.alfa,fi1=u,ok=0;var iter=0;do{p.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(u/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(fi1))/(1-this.e*Math.sin(fi1)),this.e/2))-this.s45),Math.abs(fi1-p.y)<1e-10&&(ok=1),fi1=p.y,iter+=1}while(0===ok&&iter<15);return iter>=15?null:p},exports.names=["Krovak","krovak"]},{"../common/adjust_lon":46}],89:[function(_dereq_,module,exports){var HALF_PI=Math.PI/2,FORTPI=Math.PI/4,EPSLN=1e-10,qsfnz=_dereq_("../common/qsfnz"),adjust_lon=_dereq_("../common/adjust_lon");exports.S_POLE=1,exports.N_POLE=2,exports.EQUIT=3,exports.OBLIQ=4,exports.init=function(){var t=Math.abs(this.lat0),sinphi;if(Math.abs(t-HALF_PI)<1e-10?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<1e-10?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=qsfnz(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),sinphi=Math.sin(this.lat0),this.sinb1=qsfnz(this.e,sinphi)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*sinphi*sinphi)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},exports.forward=function(p){var x,y,coslam,sinlam,sinphi,q,sinb,cosb,b,cosphi,lam=p.x,phi=p.y;if(lam=adjust_lon(lam-this.long0),this.sphere){if(sinphi=Math.sin(phi),cosphi=Math.cos(phi),coslam=Math.cos(lam),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((y=this.mode===this.EQUIT?1+cosphi*coslam:1+this.sinph0*sinphi+this.cosph0*cosphi*coslam)<=1e-10)return null;x=(y=Math.sqrt(2/y))*cosphi*Math.sin(lam),y*=this.mode===this.EQUIT?sinphi:this.cosph0*sinphi-this.sinph0*cosphi*coslam}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(coslam=-coslam),Math.abs(phi+this.phi0)<1e-10)return null;y=FORTPI-.5*phi,x=(y=2*(this.mode===this.S_POLE?Math.cos(y):Math.sin(y)))*Math.sin(lam),y*=coslam}}else{switch(sinb=0,cosb=0,b=0,coslam=Math.cos(lam),sinlam=Math.sin(lam),sinphi=Math.sin(phi),q=qsfnz(this.e,sinphi),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(sinb=q/this.qp,cosb=Math.sqrt(1-sinb*sinb)),this.mode){case this.OBLIQ:b=1+this.sinb1*sinb+this.cosb1*cosb*coslam;break;case this.EQUIT:b=1+cosb*coslam;break;case this.N_POLE:b=HALF_PI+phi,q=this.qp-q;break;case this.S_POLE:b=phi-HALF_PI,q=this.qp+q}if(Math.abs(b)<1e-10)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:b=Math.sqrt(2/b),y=this.mode===this.OBLIQ?this.ymf*b*(this.cosb1*sinb-this.sinb1*cosb*coslam):(b=Math.sqrt(2/(1+cosb*coslam)))*sinb*this.ymf,x=this.xmf*b*cosb*sinlam;break;case this.N_POLE:case this.S_POLE:q>=0?(x=(b=Math.sqrt(q))*sinlam,y=coslam*(this.mode===this.S_POLE?b:-b)):x=y=0}}return p.x=this.a*x+this.x0,p.y=this.a*y+this.y0,p},exports.inverse=function(p){p.x-=this.x0,p.y-=this.y0;var x=p.x/this.a,y=p.y/this.a,lam,phi,cCe,sCe,q,rho,ab;if(this.sphere){var cosz=0,rh,sinz=0;if((phi=.5*(rh=Math.sqrt(x*x+y*y)))>1)return null;switch(phi=2*Math.asin(phi),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(sinz=Math.sin(phi),cosz=Math.cos(phi)),this.mode){case this.EQUIT:phi=Math.abs(rh)<=1e-10?0:Math.asin(y*sinz/rh),x*=sinz,y=cosz*rh;break;case this.OBLIQ:phi=Math.abs(rh)<=1e-10?this.phi0:Math.asin(cosz*this.sinph0+y*sinz*this.cosph0/rh),x*=sinz*this.cosph0,y=(cosz-Math.sin(phi)*this.sinph0)*rh;break;case this.N_POLE:y=-y,phi=HALF_PI-phi;break;case this.S_POLE:phi-=HALF_PI}lam=0!==y||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(x,y):0}else{if(ab=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(x/=this.dd,y*=this.dd,(rho=Math.sqrt(x*x+y*y))<1e-10)return p.x=0,p.y=this.phi0,p;sCe=2*Math.asin(.5*rho/this.rq),cCe=Math.cos(sCe),x*=sCe=Math.sin(sCe),this.mode===this.OBLIQ?(ab=cCe*this.sinb1+y*sCe*this.cosb1/rho,q=this.qp*ab,y=rho*this.cosb1*cCe-y*this.sinb1*sCe):(ab=y*sCe/rho,q=this.qp*ab,y=rho*cCe)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(y=-y),!(q=x*x+y*y))return p.x=0,p.y=this.phi0,p;ab=1-q/this.qp,this.mode===this.S_POLE&&(ab=-ab)}lam=Math.atan2(x,y),phi=this.authlat(Math.asin(ab),this.apa)}return p.x=adjust_lon(this.long0+lam),p.y=phi,p},exports.P00=.3333333333333333,exports.P01=.17222222222222222,exports.P02=.10257936507936508,exports.P10=.06388888888888888,exports.P11=.0664021164021164,exports.P20=.016415012942191543,exports.authset=function(es){var t,APA=[];return APA[0]=es*this.P00,t=es*es,APA[0]+=t*this.P01,APA[1]=t*this.P10,t*=es,APA[0]+=t*this.P02,APA[1]+=t*this.P11,APA[2]=t*this.P20,APA},exports.authlat=function(beta,APA){var t=beta+beta;return beta+APA[0]*Math.sin(t)+APA[1]*Math.sin(t+t)+APA[2]*Math.sin(t+t+t)},exports.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":46,"../common/qsfnz":61}],90:[function(_dereq_,module,exports){var EPSLN=1e-10,msfnz=_dereq_("../common/msfnz"),tsfnz=_dereq_("../common/tsfnz"),HALF_PI=Math.PI/2,sign=_dereq_("../common/sign"),adjust_lon=_dereq_("../common/adjust_lon"),phi2z=_dereq_("../common/phi2z");exports.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),!(Math.abs(this.lat1+this.lat2)<1e-10)){var temp=this.b/this.a;this.e=Math.sqrt(1-temp*temp);var sin1=Math.sin(this.lat1),cos1=Math.cos(this.lat1),ms1=msfnz(this.e,sin1,cos1),ts1=tsfnz(this.e,this.lat1,sin1),sin2=Math.sin(this.lat2),cos2=Math.cos(this.lat2),ms2=msfnz(this.e,sin2,cos2),ts2=tsfnz(this.e,this.lat2,sin2),ts0=tsfnz(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>1e-10?this.ns=Math.log(ms1/ms2)/Math.log(ts1/ts2):this.ns=sin1,isNaN(this.ns)&&(this.ns=sin1),this.f0=ms1/(this.ns*Math.pow(ts1,this.ns)),this.rh=this.a*this.f0*Math.pow(ts0,this.ns),this.title||(this.title="Lambert Conformal Conic")}},exports.forward=function(p){var lon=p.x,lat=p.y;Math.abs(2*Math.abs(lat)-Math.PI)<=1e-10&&(lat=sign(lat)*(HALF_PI-2e-10));var con=Math.abs(Math.abs(lat)-HALF_PI),ts,rh1;if(con>1e-10)ts=tsfnz(this.e,lat,Math.sin(lat)),rh1=this.a*this.f0*Math.pow(ts,this.ns);else{if((con=lat*this.ns)<=0)return null;rh1=0}var theta=this.ns*adjust_lon(lon-this.long0);return p.x=this.k0*(rh1*Math.sin(theta))+this.x0,p.y=this.k0*(this.rh-rh1*Math.cos(theta))+this.y0,p},exports.inverse=function(p){var rh1,con,ts,lat,lon,x=(p.x-this.x0)/this.k0,y=this.rh-(p.y-this.y0)/this.k0;this.ns>0?(rh1=Math.sqrt(x*x+y*y),con=1):(rh1=-Math.sqrt(x*x+y*y),con=-1);var theta=0;if(0!==rh1&&(theta=Math.atan2(con*x,con*y)),0!==rh1||this.ns>0){if(con=1/this.ns,ts=Math.pow(rh1/(this.a*this.f0),con),-9999===(lat=phi2z(this.e,ts)))return null}else lat=-HALF_PI;return lon=adjust_lon(theta/this.ns+this.long0),p.x=lon,p.y=lat,p},exports.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":46,"../common/msfnz":56,"../common/phi2z":57,"../common/sign":62,"../common/tsfnz":64}],91:[function(_dereq_,module,exports){function identity(pt){return pt}exports.init=function(){},exports.forward=identity,exports.inverse=identity,exports.names=["longlat","identity"]},{}],92:[function(_dereq_,module,exports){var msfnz=_dereq_("../common/msfnz"),HALF_PI=Math.PI/2,EPSLN=1e-10,R2D=57.29577951308232,adjust_lon=_dereq_("../common/adjust_lon"),FORTPI=Math.PI/4,tsfnz=_dereq_("../common/tsfnz"),phi2z=_dereq_("../common/phi2z");exports.init=function(){var con=this.b/this.a;this.es=1-con*con,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},exports.forward=function(p){var lon=p.x,lat=p.y,x,y;if(lat*R2D>90&&lat*R2D<-90&&lon*R2D>180&&lon*R2D<-180)return null;if(Math.abs(Math.abs(lat)-HALF_PI)<=1e-10)return null;if(this.sphere)x=this.x0+this.a*this.k0*adjust_lon(lon-this.long0),y=this.y0+this.a*this.k0*Math.log(Math.tan(FORTPI+.5*lat));else{var sinphi=Math.sin(lat),ts=tsfnz(this.e,lat,sinphi);x=this.x0+this.a*this.k0*adjust_lon(lon-this.long0),y=this.y0-this.a*this.k0*Math.log(ts)}return p.x=x,p.y=y,p},exports.inverse=function(p){var x=p.x-this.x0,y=p.y-this.y0,lon,lat;if(this.sphere)lat=HALF_PI-2*Math.atan(Math.exp(-y/(this.a*this.k0)));else{var ts=Math.exp(-y/(this.a*this.k0));if(-9999===(lat=phi2z(this.e,ts)))return null}return lon=adjust_lon(this.long0+x/(this.a*this.k0)),p.x=lon,p.y=lat,p},exports.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":46,"../common/msfnz":56,"../common/phi2z":57,"../common/tsfnz":64}],93:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon");exports.init=function(){},exports.forward=function(p){var lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0),x=this.x0+this.a*dlon,y=this.y0+this.a*Math.log(Math.tan(Math.PI/4+lat/2.5))*1.25;return p.x=x,p.y=y,p},exports.inverse=function(p){p.x-=this.x0,p.y-=this.y0;var lon=adjust_lon(this.long0+p.x/this.a),lat=2.5*(Math.atan(Math.exp(.8*p.y/this.a))-Math.PI/4);return p.x=lon,p.y=lat,p},exports.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":46}],94:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon"),EPSLN=1e-10;exports.init=function(){},exports.forward=function(p){for(var lon=p.x,lat=p.y,delta_lon=adjust_lon(lon-this.long0),theta=lat,con=Math.PI*Math.sin(lat),i=0;;i++){var delta_theta=-(theta+Math.sin(theta)-con)/(1+Math.cos(theta));if(theta+=delta_theta,Math.abs(delta_theta)<1e-10)break}theta/=2,Math.PI/2-Math.abs(lat)<1e-10&&(delta_lon=0);var x=.900316316158*this.a*delta_lon*Math.cos(theta)+this.x0,y=1.4142135623731*this.a*Math.sin(theta)+this.y0;return p.x=x,p.y=y,p},exports.inverse=function(p){var theta,arg;p.x-=this.x0,p.y-=this.y0,arg=p.y/(1.4142135623731*this.a),Math.abs(arg)>.999999999999&&(arg=.999999999999),theta=Math.asin(arg);var lon=adjust_lon(this.long0+p.x/(.900316316158*this.a*Math.cos(theta)));lon<-Math.PI&&(lon=-Math.PI),lon>Math.PI&&(lon=Math.PI),arg=(2*theta+Math.sin(2*theta))/Math.PI,Math.abs(arg)>1&&(arg=1);var lat=Math.asin(arg);return p.x=lon,p.y=lat,p},exports.names=["Mollweide","moll"]},{"../common/adjust_lon":46}],95:[function(_dereq_,module,exports){var SEC_TO_RAD=484813681109536e-20;exports.iterations=1,exports.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},exports.forward=function(p){var n,lon=p.x,lat,delta_lat=p.y-this.lat0,delta_lon=lon-this.long0,d_phi=delta_lat/SEC_TO_RAD*1e-5,d_lambda=delta_lon,d_phi_n=1,d_psi=0;for(n=1;n<=10;n++)d_phi_n*=d_phi,d_psi+=this.A[n]*d_phi_n;var th_re=d_psi,th_im=d_lambda,th_n_re=1,th_n_im=0,th_n_re1,th_n_im1,z_re=0,z_im=0;for(n=1;n<=6;n++)th_n_im1=th_n_im*th_re+th_n_re*th_im,th_n_re=th_n_re1=th_n_re*th_re-th_n_im*th_im,th_n_im=th_n_im1,z_re=z_re+this.B_re[n]*th_n_re-this.B_im[n]*th_n_im,z_im=z_im+this.B_im[n]*th_n_re+this.B_re[n]*th_n_im;return p.x=z_im*this.a+this.x0,p.y=z_re*this.a+this.y0,p},exports.inverse=function(p){var n,x=p.x,y=p.y,delta_x=x-this.x0,delta_y,z_re=(y-this.y0)/this.a,z_im=delta_x/this.a,z_n_re=1,z_n_im=0,z_n_re1,z_n_im1,th_re=0,th_im=0;for(n=1;n<=6;n++)z_n_im1=z_n_im*z_re+z_n_re*z_im,z_n_re=z_n_re1=z_n_re*z_re-z_n_im*z_im,z_n_im=z_n_im1,th_re=th_re+this.C_re[n]*z_n_re-this.C_im[n]*z_n_im,th_im=th_im+this.C_im[n]*z_n_re+this.C_re[n]*z_n_im;for(var i=0;i<this.iterations;i++){var th_n_re=th_re,th_n_im=th_im,th_n_re1,th_n_im1,num_re=z_re,num_im=z_im;for(n=2;n<=6;n++)th_n_im1=th_n_im*th_re+th_n_re*th_im,th_n_re=th_n_re1=th_n_re*th_re-th_n_im*th_im,th_n_im=th_n_im1,num_re+=(n-1)*(this.B_re[n]*th_n_re-this.B_im[n]*th_n_im),num_im+=(n-1)*(this.B_im[n]*th_n_re+this.B_re[n]*th_n_im);th_n_re=1,th_n_im=0;var den_re=this.B_re[1],den_im=this.B_im[1];for(n=2;n<=6;n++)th_n_im1=th_n_im*th_re+th_n_re*th_im,th_n_re=th_n_re1=th_n_re*th_re-th_n_im*th_im,th_n_im=th_n_im1,den_re+=n*(this.B_re[n]*th_n_re-this.B_im[n]*th_n_im),den_im+=n*(this.B_im[n]*th_n_re+this.B_re[n]*th_n_im);var den2=den_re*den_re+den_im*den_im;th_re=(num_re*den_re+num_im*den_im)/den2,th_im=(num_im*den_re-num_re*den_im)/den2}var d_psi=th_re,d_lambda=th_im,d_psi_n=1,d_phi=0;for(n=1;n<=9;n++)d_psi_n*=d_psi,d_phi+=this.D[n]*d_psi_n;var lat=this.lat0+d_phi*SEC_TO_RAD*1e5,lon=this.long0+d_lambda;return p.x=lon,p.y=lat,p},exports.names=["New_Zealand_Map_Grid","nzmg"]},{}],96:[function(_dereq_,module,exports){var tsfnz=_dereq_("../common/tsfnz"),adjust_lon=_dereq_("../common/adjust_lon"),phi2z=_dereq_("../common/phi2z"),HALF_PI=Math.PI/2,FORTPI=Math.PI/4,EPSLN=1e-10;exports.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var sinlat=Math.sin(this.lat0),coslat=Math.cos(this.lat0),con=this.e*sinlat;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(coslat,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-con*con);var t0=tsfnz(this.e,this.lat0,sinlat),dl=this.bl/coslat*Math.sqrt((1-this.es)/(1-con*con)),fl,gl;if(dl*dl<1&&(dl=1),isNaN(this.longc)){var t1=tsfnz(this.e,this.lat1,Math.sin(this.lat1)),t2=tsfnz(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(dl+Math.sqrt(dl*dl-1))*Math.pow(t0,this.bl):this.el=(dl-Math.sqrt(dl*dl-1))*Math.pow(t0,this.bl);var hl=Math.pow(t1,this.bl),ll=Math.pow(t2,this.bl);gl=.5*((fl=this.el/hl)-1/fl);var jl=(this.el*this.el-ll*hl)/(this.el*this.el+ll*hl),pl=(ll-hl)/(ll+hl),dlon12=adjust_lon(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(jl*Math.tan(.5*this.bl*dlon12)/pl)/this.bl,this.long0=adjust_lon(this.long0);var dlon10=adjust_lon(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*dlon10)/gl),this.alpha=Math.asin(dl*Math.sin(this.gamma0))}else fl=this.lat0>=0?dl+Math.sqrt(dl*dl-1):dl-Math.sqrt(dl*dl-1),this.el=fl*Math.pow(t0,this.bl),gl=.5*(fl-1/fl),this.gamma0=Math.asin(Math.sin(this.alpha)/dl),this.long0=this.longc-Math.asin(gl*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(dl*dl-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(dl*dl-1),Math.cos(this.alpha))},exports.forward=function(p){var lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0),us,vs,con;if(Math.abs(Math.abs(lat)-HALF_PI)<=1e-10)con=lat>0?-1:1,vs=this.al/this.bl*Math.log(Math.tan(FORTPI+con*this.gamma0*.5)),us=-1*con*HALF_PI*this.al/this.bl;else{var t=tsfnz(this.e,lat,Math.sin(lat)),ql=this.el/Math.pow(t,this.bl),sl=.5*(ql-1/ql),tl=.5*(ql+1/ql),vl=Math.sin(this.bl*dlon),ul=(sl*Math.sin(this.gamma0)-vl*Math.cos(this.gamma0))/tl;vs=Math.abs(Math.abs(ul)-1)<=1e-10?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-ul)/(1+ul))/this.bl,us=Math.abs(Math.cos(this.bl*dlon))<=1e-10?this.al*this.bl*dlon:this.al*Math.atan2(sl*Math.cos(this.gamma0)+vl*Math.sin(this.gamma0),Math.cos(this.bl*dlon))/this.bl}return this.no_rot?(p.x=this.x0+us,p.y=this.y0+vs):(us-=this.uc,p.x=this.x0+vs*Math.cos(this.alpha)+us*Math.sin(this.alpha),p.y=this.y0+us*Math.cos(this.alpha)-vs*Math.sin(this.alpha)),p},exports.inverse=function(p){var us,vs;this.no_rot?(vs=p.y-this.y0,us=p.x-this.x0):(vs=(p.x-this.x0)*Math.cos(this.alpha)-(p.y-this.y0)*Math.sin(this.alpha),us=(p.y-this.y0)*Math.cos(this.alpha)+(p.x-this.x0)*Math.sin(this.alpha),us+=this.uc);var qp=Math.exp(-1*this.bl*vs/this.al),sp=.5*(qp-1/qp),tp=.5*(qp+1/qp),vp=Math.sin(this.bl*us/this.al),up=(vp*Math.cos(this.gamma0)+sp*Math.sin(this.gamma0))/tp,ts=Math.pow(this.el/Math.sqrt((1+up)/(1-up)),1/this.bl);return Math.abs(up-1)<1e-10?(p.x=this.long0,p.y=HALF_PI):Math.abs(up+1)<1e-10?(p.x=this.long0,p.y=-1*HALF_PI):(p.y=phi2z(this.e,ts),p.x=adjust_lon(this.long0-Math.atan2(sp*Math.cos(this.gamma0)-vp*Math.sin(this.gamma0),Math.cos(this.bl*us/this.al))/this.bl)),p},exports.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":46,"../common/phi2z":57,"../common/tsfnz":64}],97:[function(_dereq_,module,exports){var e0fn=_dereq_("../common/e0fn"),e1fn=_dereq_("../common/e1fn"),e2fn=_dereq_("../common/e2fn"),e3fn=_dereq_("../common/e3fn"),adjust_lon=_dereq_("../common/adjust_lon"),adjust_lat=_dereq_("../common/adjust_lat"),mlfn=_dereq_("../common/mlfn"),EPSLN=1e-10,gN=_dereq_("../common/gN"),MAX_ITER=20;exports.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.ml0=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},exports.forward=function(p){var lon=p.x,lat=p.y,x,y,el,dlon=adjust_lon(lon-this.long0);if(el=dlon*Math.sin(lat),this.sphere)Math.abs(lat)<=1e-10?(x=this.a*dlon,y=-1*this.a*this.lat0):(x=this.a*Math.sin(el)/Math.tan(lat),y=this.a*(adjust_lat(lat-this.lat0)+(1-Math.cos(el))/Math.tan(lat)));else if(Math.abs(lat)<=1e-10)x=this.a*dlon,y=-1*this.ml0;else{var nl=gN(this.a,this.e,Math.sin(lat))/Math.tan(lat);x=nl*Math.sin(el),y=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,lat)-this.ml0+nl*(1-Math.cos(el))}return p.x=x+this.x0,p.y=y+this.y0,p},exports.inverse=function(p){var lon,lat,x,y,i,al,bl,phi,dphi;if(x=p.x-this.x0,y=p.y-this.y0,this.sphere)if(Math.abs(y+this.a*this.lat0)<=1e-10)lon=adjust_lon(x/this.a+this.long0),lat=0;else{var tanphi;for(al=this.lat0+y/this.a,bl=x*x/this.a/this.a+al*al,phi=al,i=20;i;--i)if(phi+=dphi=-1*(al*(phi*(tanphi=Math.tan(phi))+1)-phi-.5*(phi*phi+bl)*tanphi)/((phi-al)/tanphi-1),Math.abs(dphi)<=1e-10){lat=phi;break}lon=adjust_lon(this.long0+Math.asin(x*Math.tan(phi)/this.a)/Math.sin(lat))}else if(Math.abs(y+this.ml0)<=1e-10)lat=0,lon=adjust_lon(this.long0+x/this.a);else{var cl,mln,mlnp,ma,con;for(al=(this.ml0+y)/this.a,bl=x*x/this.a/this.a+al*al,phi=al,i=20;i;--i)if(con=this.e*Math.sin(phi),cl=Math.sqrt(1-con*con)*Math.tan(phi),mln=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,phi),mlnp=this.e0-2*this.e1*Math.cos(2*phi)+4*this.e2*Math.cos(4*phi)-6*this.e3*Math.cos(6*phi),phi-=dphi=(al*(cl*(ma=mln/this.a)+1)-ma-.5*cl*(ma*ma+bl))/(this.es*Math.sin(2*phi)*(ma*ma+bl-2*al*ma)/(4*cl)+(al-ma)*(cl*mlnp-2/Math.sin(2*phi))-mlnp),Math.abs(dphi)<=1e-10){lat=phi;break}cl=Math.sqrt(1-this.es*Math.pow(Math.sin(lat),2))*Math.tan(lat),lon=adjust_lon(this.long0+Math.asin(x*cl/this.a)/Math.sin(lat))}return p.x=lon,p.y=lat,p},exports.names=["Polyconic","poly"]},{"../common/adjust_lat":45,"../common/adjust_lon":46,"../common/e0fn":48,"../common/e1fn":49,"../common/e2fn":50,"../common/e3fn":51,"../common/gN":52,"../common/mlfn":55}],98:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon"),adjust_lat=_dereq_("../common/adjust_lat"),pj_enfn=_dereq_("../common/pj_enfn"),MAX_ITER=20,pj_mlfn=_dereq_("../common/pj_mlfn"),pj_inv_mlfn=_dereq_("../common/pj_inv_mlfn"),HALF_PI=Math.PI/2,EPSLN=1e-10,asinz=_dereq_("../common/asinz");exports.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=pj_enfn(this.es)},exports.forward=function(p){var x,y,lon=p.x,lat=p.y;if(lon=adjust_lon(lon-this.long0),this.sphere){if(this.m)for(var k=this.n*Math.sin(lat),i=20;i;--i){var V=(this.m*lat+Math.sin(lat)-k)/(this.m+Math.cos(lat));if(lat-=V,Math.abs(V)<1e-10)break}else lat=1!==this.n?Math.asin(this.n*Math.sin(lat)):lat;x=this.a*this.C_x*lon*(this.m+Math.cos(lat)),y=this.a*this.C_y*lat}else{var s=Math.sin(lat),c=Math.cos(lat);y=this.a*pj_mlfn(lat,s,c,this.en),x=this.a*lon*c/Math.sqrt(1-this.es*s*s)}return p.x=x,p.y=y,p},exports.inverse=function(p){var lat,temp,lon,s;return p.x-=this.x0,lon=p.x/this.a,p.y-=this.y0,lat=p.y/this.a,this.sphere?(lat/=this.C_y,lon/=this.C_x*(this.m+Math.cos(lat)),this.m?lat=asinz((this.m*lat+Math.sin(lat))/this.n):1!==this.n&&(lat=asinz(Math.sin(lat)/this.n)),lon=adjust_lon(lon+this.long0),lat=adjust_lat(lat)):(lat=pj_inv_mlfn(p.y/this.a,this.es,this.en),(s=Math.abs(lat))<HALF_PI?(s=Math.sin(lat),temp=this.long0+p.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(lat)),lon=adjust_lon(temp)):s-1e-10<HALF_PI&&(lon=this.long0)),p.x=lon,p.y=lat,p},exports.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":45,"../common/adjust_lon":46,"../common/asinz":47,"../common/pj_enfn":58,"../common/pj_inv_mlfn":59,"../common/pj_mlfn":60}],99:[function(_dereq_,module,exports){exports.init=function(){var phy0=this.lat0;this.lambda0=this.long0;var sinPhy0=Math.sin(phy0),semiMajorAxis=this.a,invF,flattening=1/this.rf,e2=2*flattening-Math.pow(flattening,2),e=this.e=Math.sqrt(e2);this.R=this.k0*semiMajorAxis*Math.sqrt(1-e2)/(1-e2*Math.pow(sinPhy0,2)),this.alpha=Math.sqrt(1+e2/(1-e2)*Math.pow(Math.cos(phy0),4)),this.b0=Math.asin(sinPhy0/this.alpha);var k1=Math.log(Math.tan(Math.PI/4+this.b0/2)),k2=Math.log(Math.tan(Math.PI/4+phy0/2)),k3=Math.log((1+e*sinPhy0)/(1-e*sinPhy0));this.K=k1-this.alpha*k2+this.alpha*e/2*k3},exports.forward=function(p){var Sa1=Math.log(Math.tan(Math.PI/4-p.y/2)),Sa2=this.e/2*Math.log((1+this.e*Math.sin(p.y))/(1-this.e*Math.sin(p.y))),S=-this.alpha*(Sa1+Sa2)+this.K,b=2*(Math.atan(Math.exp(S))-Math.PI/4),I=this.alpha*(p.x-this.lambda0),rotI=Math.atan(Math.sin(I)/(Math.sin(this.b0)*Math.tan(b)+Math.cos(this.b0)*Math.cos(I))),rotB=Math.asin(Math.cos(this.b0)*Math.sin(b)-Math.sin(this.b0)*Math.cos(b)*Math.cos(I));return p.y=this.R/2*Math.log((1+Math.sin(rotB))/(1-Math.sin(rotB)))+this.y0,p.x=this.R*rotI+this.x0,p},exports.inverse=function(p){for(var Y=p.x-this.x0,X=p.y-this.y0,rotI=Y/this.R,rotB=2*(Math.atan(Math.exp(X/this.R))-Math.PI/4),b=Math.asin(Math.cos(this.b0)*Math.sin(rotB)+Math.sin(this.b0)*Math.cos(rotB)*Math.cos(rotI)),I=Math.atan(Math.sin(rotI)/(Math.cos(this.b0)*Math.cos(rotI)-Math.sin(this.b0)*Math.tan(rotB))),lambda=this.lambda0+I/this.alpha,S=0,phy=b,prevPhy=-1e3,iteration=0;Math.abs(phy-prevPhy)>1e-7;){if(++iteration>20)return;S=1/this.alpha*(Math.log(Math.tan(Math.PI/4+b/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(phy))/2)),prevPhy=phy,phy=2*Math.atan(Math.exp(S))-Math.PI/2}return p.x=lambda,p.y=phy,p},exports.names=["somerc"]},{}],100:[function(_dereq_,module,exports){var HALF_PI=Math.PI/2,EPSLN=1e-10,sign=_dereq_("../common/sign"),msfnz=_dereq_("../common/msfnz"),tsfnz=_dereq_("../common/tsfnz"),phi2z=_dereq_("../common/phi2z"),adjust_lon=_dereq_("../common/adjust_lon");exports.ssfn_=function(phit,sinphi,eccen){return sinphi*=eccen,Math.tan(.5*(HALF_PI+phit))*Math.pow((1-sinphi)/(1+sinphi),.5*eccen)},exports.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=1e-10&&(this.k0=.5*(1+sign(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=1e-10&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=1e-10&&(this.k0=.5*this.cons*msfnz(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/tsfnz(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=msfnz(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-HALF_PI,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},exports.forward=function(p){var lon=p.x,lat=p.y,sinlat=Math.sin(lat),coslat=Math.cos(lat),A,X,sinX,cosX,ts,rh,dlon=adjust_lon(lon-this.long0);return Math.abs(Math.abs(lon-this.long0)-Math.PI)<=1e-10&&Math.abs(lat+this.lat0)<=1e-10?(p.x=NaN,p.y=NaN,p):this.sphere?(A=2*this.k0/(1+this.sinlat0*sinlat+this.coslat0*coslat*Math.cos(dlon)),p.x=this.a*A*coslat*Math.sin(dlon)+this.x0,p.y=this.a*A*(this.coslat0*sinlat-this.sinlat0*coslat*Math.cos(dlon))+this.y0,p):(X=2*Math.atan(this.ssfn_(lat,sinlat,this.e))-HALF_PI,cosX=Math.cos(X),sinX=Math.sin(X),Math.abs(this.coslat0)<=1e-10?(ts=tsfnz(this.e,lat*this.con,this.con*sinlat),rh=2*this.a*this.k0*ts/this.cons,p.x=this.x0+rh*Math.sin(lon-this.long0),p.y=this.y0-this.con*rh*Math.cos(lon-this.long0),p):(Math.abs(this.sinlat0)<1e-10?(A=2*this.a*this.k0/(1+cosX*Math.cos(dlon)),p.y=A*sinX):(A=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*sinX+this.cosX0*cosX*Math.cos(dlon))),p.y=A*(this.cosX0*sinX-this.sinX0*cosX*Math.cos(dlon))+this.y0),p.x=A*cosX*Math.sin(dlon)+this.x0,p))},exports.inverse=function(p){var lon,lat,ts,ce,Chi;p.x-=this.x0,p.y-=this.y0;var rh=Math.sqrt(p.x*p.x+p.y*p.y);if(this.sphere){var c=2*Math.atan(rh/(.5*this.a*this.k0));return lon=this.long0,lat=this.lat0,rh<=1e-10?(p.x=lon,p.y=lat,p):(lat=Math.asin(Math.cos(c)*this.sinlat0+p.y*Math.sin(c)*this.coslat0/rh),lon=Math.abs(this.coslat0)<1e-10?this.lat0>0?adjust_lon(this.long0+Math.atan2(p.x,-1*p.y)):adjust_lon(this.long0+Math.atan2(p.x,p.y)):adjust_lon(this.long0+Math.atan2(p.x*Math.sin(c),rh*this.coslat0*Math.cos(c)-p.y*this.sinlat0*Math.sin(c))),p.x=lon,p.y=lat,p)}if(Math.abs(this.coslat0)<=1e-10){if(rh<=1e-10)return lat=this.lat0,lon=this.long0,p.x=lon,p.y=lat,p;p.x*=this.con,p.y*=this.con,ts=rh*this.cons/(2*this.a*this.k0),lat=this.con*phi2z(this.e,ts),lon=this.con*adjust_lon(this.con*this.long0+Math.atan2(p.x,-1*p.y))}else ce=2*Math.atan(rh*this.cosX0/(2*this.a*this.k0*this.ms1)),lon=this.long0,rh<=1e-10?Chi=this.X0:(Chi=Math.asin(Math.cos(ce)*this.sinX0+p.y*Math.sin(ce)*this.cosX0/rh),lon=adjust_lon(this.long0+Math.atan2(p.x*Math.sin(ce),rh*this.cosX0*Math.cos(ce)-p.y*this.sinX0*Math.sin(ce)))),lat=-1*phi2z(this.e,Math.tan(.5*(HALF_PI+Chi)));return p.x=lon,p.y=lat,p},exports.names=["stere"]},{"../common/adjust_lon":46,"../common/msfnz":56,"../common/phi2z":57,"../common/sign":62,"../common/tsfnz":64}],101:[function(_dereq_,module,exports){var gauss=_dereq_("./gauss"),adjust_lon=_dereq_("../common/adjust_lon");exports.init=function(){gauss.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},exports.forward=function(p){var sinc,cosc,cosl,k;return p.x=adjust_lon(p.x-this.long0),gauss.forward.apply(this,[p]),sinc=Math.sin(p.y),cosc=Math.cos(p.y),cosl=Math.cos(p.x),k=this.k0*this.R2/(1+this.sinc0*sinc+this.cosc0*cosc*cosl),p.x=k*cosc*Math.sin(p.x),p.y=k*(this.cosc0*sinc-this.sinc0*cosc*cosl),p.x=this.a*p.x+this.x0,p.y=this.a*p.y+this.y0,p},exports.inverse=function(p){var sinc,cosc,lon,lat,rho;if(p.x=(p.x-this.x0)/this.a,p.y=(p.y-this.y0)/this.a,p.x/=this.k0,p.y/=this.k0,rho=Math.sqrt(p.x*p.x+p.y*p.y)){var c=2*Math.atan2(rho,this.R2);sinc=Math.sin(c),cosc=Math.cos(c),lat=Math.asin(cosc*this.sinc0+p.y*sinc*this.cosc0/rho),lon=Math.atan2(p.x*sinc,rho*this.cosc0*cosc-p.y*this.sinc0*sinc)}else lat=this.phic0,lon=0;return p.x=lon,p.y=lat,gauss.inverse.apply(this,[p]),p.x=adjust_lon(p.x+this.long0),p},exports.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":46,"./gauss":86}],102:[function(_dereq_,module,exports){var e0fn=_dereq_("../common/e0fn"),e1fn=_dereq_("../common/e1fn"),e2fn=_dereq_("../common/e2fn"),e3fn=_dereq_("../common/e3fn"),mlfn=_dereq_("../common/mlfn"),adjust_lon=_dereq_("../common/adjust_lon"),HALF_PI=Math.PI/2,EPSLN=1e-10,sign=_dereq_("../common/sign"),asinz=_dereq_("../common/asinz");exports.init=function(){this.e0=e0fn(this.es),this.e1=e1fn(this.es),this.e2=e2fn(this.es),this.e3=e3fn(this.es),this.ml0=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,this.lat0)},exports.forward=function(p){var lon=p.x,lat=p.y,delta_lon=adjust_lon(lon-this.long0),con,x,y,sin_phi=Math.sin(lat),cos_phi=Math.cos(lat);if(this.sphere){var b=cos_phi*Math.sin(delta_lon);if(Math.abs(Math.abs(b)-1)<1e-10)return 93;x=.5*this.a*this.k0*Math.log((1+b)/(1-b)),con=Math.acos(cos_phi*Math.cos(delta_lon)/Math.sqrt(1-b*b)),lat<0&&(con=-con),y=this.a*this.k0*(con-this.lat0)}else{var al=cos_phi*delta_lon,als=Math.pow(al,2),c=this.ep2*Math.pow(cos_phi,2),tq=Math.tan(lat),t=Math.pow(tq,2);con=1-this.es*Math.pow(sin_phi,2);var n=this.a/Math.sqrt(con),ml=this.a*mlfn(this.e0,this.e1,this.e2,this.e3,lat);x=this.k0*n*al*(1+als/6*(1-t+c+als/20*(5-18*t+Math.pow(t,2)+72*c-58*this.ep2)))+this.x0,y=this.k0*(ml-this.ml0+n*tq*(als*(.5+als/24*(5-t+9*c+4*Math.pow(c,2)+als/30*(61-58*t+Math.pow(t,2)+600*c-330*this.ep2)))))+this.y0}return p.x=x,p.y=y,p},exports.inverse=function(p){var con,phi,delta_phi,i,max_iter=6,lat,lon;if(this.sphere){var f=Math.exp(p.x/(this.a*this.k0)),g=.5*(f-1/f),temp=this.lat0+p.y/(this.a*this.k0),h=Math.cos(temp);con=Math.sqrt((1-h*h)/(1+g*g)),lat=asinz(con),temp<0&&(lat=-lat),lon=0===g&&0===h?this.long0:adjust_lon(Math.atan2(g,h)+this.long0)}else{var x=p.x-this.x0,y=p.y-this.y0;for(phi=con=(this.ml0+y/this.k0)/this.a,i=0;phi+=delta_phi=(con+this.e1*Math.sin(2*phi)-this.e2*Math.sin(4*phi)+this.e3*Math.sin(6*phi))/this.e0-phi,!(Math.abs(delta_phi)<=1e-10);i++)if(i>=6)return 95;if(Math.abs(phi)<HALF_PI){var sin_phi=Math.sin(phi),cos_phi=Math.cos(phi),tan_phi=Math.tan(phi),c=this.ep2*Math.pow(cos_phi,2),cs=Math.pow(c,2),t=Math.pow(tan_phi,2),ts=Math.pow(t,2);con=1-this.es*Math.pow(sin_phi,2);var n=this.a/Math.sqrt(con),r=n*(1-this.es)/con,d=x/(n*this.k0),ds=Math.pow(d,2);lat=phi-n*tan_phi*ds/r*(.5-ds/24*(5+3*t+10*c-4*cs-9*this.ep2-ds/30*(61+90*t+298*c+45*ts-252*this.ep2-3*cs))),lon=adjust_lon(this.long0+d*(1-ds/6*(1+2*t+c-ds/20*(5-2*c+28*t-3*cs+8*this.ep2+24*ts)))/cos_phi)}else lat=HALF_PI*sign(y),lon=this.long0}return p.x=lon,p.y=lat,p},exports.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":46,"../common/asinz":47,"../common/e0fn":48,"../common/e1fn":49,"../common/e2fn":50,"../common/e3fn":51,"../common/mlfn":55,"../common/sign":62}],103:[function(_dereq_,module,exports){var D2R=.017453292519943295,tmerc=_dereq_("./tmerc");exports.dependsOn="tmerc",exports.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*D2R,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,tmerc.init.apply(this),this.forward=tmerc.forward,this.inverse=tmerc.inverse)},exports.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":102}],104:[function(_dereq_,module,exports){var adjust_lon=_dereq_("../common/adjust_lon"),HALF_PI=Math.PI/2,EPSLN=1e-10,asinz=_dereq_("../common/asinz");exports.init=function(){this.R=this.a},exports.forward=function(p){var lon=p.x,lat=p.y,dlon=adjust_lon(lon-this.long0),x,y;Math.abs(lat)<=1e-10&&(x=this.x0+this.R*dlon,y=this.y0);var theta=asinz(2*Math.abs(lat/Math.PI));(Math.abs(dlon)<=1e-10||Math.abs(Math.abs(lat)-HALF_PI)<=1e-10)&&(x=this.x0,y=lat>=0?this.y0+Math.PI*this.R*Math.tan(.5*theta):this.y0+Math.PI*this.R*-Math.tan(.5*theta));var al=.5*Math.abs(Math.PI/dlon-dlon/Math.PI),asq=al*al,sinth=Math.sin(theta),costh=Math.cos(theta),g=costh/(sinth+costh-1),gsq=g*g,m=g*(2/sinth-1),msq=m*m,con=Math.PI*this.R*(al*(g-msq)+Math.sqrt(asq*(g-msq)*(g-msq)-(msq+asq)*(gsq-msq)))/(msq+asq);dlon<0&&(con=-con),x=this.x0+con;var q=asq+g;return con=Math.PI*this.R*(m*q-al*Math.sqrt((msq+asq)*(asq+1)-q*q))/(msq+asq),y=lat>=0?this.y0+con:this.y0-con,p.x=x,p.y=y,p},exports.inverse=function(p){var lon,lat,xx,yy,xys,c1,c2,c3,a1,m1,con,th1,d;return p.x-=this.x0,p.y-=this.y0,con=Math.PI*this.R,xys=(xx=p.x/con)*xx+(yy=p.y/con)*yy,con=3*(d=yy*yy/(c3=-2*(c1=-Math.abs(yy)*(1+xys))+1+2*yy*yy+xys*xys)+(2*(c2=c1-2*yy*yy+xx*xx)*c2*c2/c3/c3/c3-9*c1*c2/c3/c3)/27)/(a1=(c1-c2*c2/3/c3)/c3)/(m1=2*Math.sqrt(-a1/3)),Math.abs(con)>1&&(con=con>=0?1:-1),th1=Math.acos(con)/3,lat=p.y>=0?(-m1*Math.cos(th1+Math.PI/3)-c2/3/c3)*Math.PI:-(-m1*Math.cos(th1+Math.PI/3)-c2/3/c3)*Math.PI,lon=Math.abs(xx)<1e-10?this.long0:adjust_lon(this.long0+Math.PI*(xys-1+Math.sqrt(1+2*(xx*xx-yy*yy)+xys*xys))/2/xx),p.x=lon,p.y=lat,p},exports.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":46,"../common/asinz":47}],105:[function(_dereq_,module,exports){var D2R=.017453292519943295,R2D=57.29577951308232,PJD_3PARAM=1,PJD_7PARAM=2,datum_transform=_dereq_("./datum_transform"),adjust_axis=_dereq_("./adjust_axis"),proj=_dereq_("./Proj");module.exports=function transform(source,dest,point){var wgs84;function checkNotWGS(source,dest){return(source.datum.datum_type===PJD_3PARAM||source.datum.datum_type===PJD_7PARAM)&&"WGS84"!==dest.datumCode}return source.datum&&dest.datum&&(checkNotWGS(source,dest)||checkNotWGS(dest,source))&&(transform(source,wgs84=new proj("WGS84"),point),source=wgs84),"enu"!==source.axis&&adjust_axis(source,!1,point),"longlat"===source.projName?(point.x*=D2R,point.y*=D2R):(source.to_meter&&(point.x*=source.to_meter,point.y*=source.to_meter),source.inverse(point)),source.from_greenwich&&(point.x+=source.from_greenwich),point=datum_transform(source.datum,dest.datum,point),dest.from_greenwich&&(point.x-=dest.from_greenwich),"longlat"===dest.projName?(point.x*=R2D,point.y*=R2D):(dest.forward(point),dest.to_meter&&(point.x/=dest.to_meter,point.y/=dest.to_meter)),"enu"!==dest.axis&&adjust_axis(dest,!0,point),point}},{"./Proj":43,"./adjust_axis":44,"./datum_transform":70}],106:[function(_dereq_,module,exports){module.exports="2.1.0"},{}],107:[function(_dereq_,module,exports){var D2R=.017453292519943295,extend=_dereq_("./extend");function mapit(obj,key,v){obj[key]=v.map((function(aa){var o={};return sExpr(aa,o),o})).reduce((function(a,b){return extend(a,b)}),{})}function sExpr(v,obj){var key;Array.isArray(v)?("PARAMETER"===(key=v.shift())&&(key=v.shift()),1===v.length?Array.isArray(v[0])?(obj[key]={},sExpr(v[0],obj[key])):obj[key]=v[0]:v.length?"TOWGS84"===key?obj[key]=v:(obj[key]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(key)>-1?(obj[key]={name:v[0].toLowerCase(),convert:v[1]},3===v.length&&(obj[key].auth=v[2])):"SPHEROID"===key?(obj[key]={name:v[0],a:v[1],rf:v[2]},4===v.length&&(obj[key].auth=v[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(key)>-1?(v[0]=["name",v[0]],mapit(obj,key,v)):v.every((function(aa){return Array.isArray(aa)}))?mapit(obj,key,v):sExpr(v,obj[key])):obj[key]=!0):obj[v]=!0}function rename(obj,params){var outName=params[0],inName=params[1];!(outName in obj)&&inName in obj&&(obj[outName]=obj[inName],3===params.length&&(obj[outName]=params[2](obj[outName])))}function d2r(input){return input*D2R}function cleanWKT(wkt){function toMeter(input){var ratio=wkt.to_meter||1;return parseFloat(input,10)*ratio}var renamer,list;"GEOGCS"===wkt.type?wkt.projName="longlat":"LOCAL_CS"===wkt.type?(wkt.projName="identity",wkt.local=!0):"object"==typeof wkt.PROJECTION?wkt.projName=Object.keys(wkt.PROJECTION)[0]:wkt.projName=wkt.PROJECTION,wkt.UNIT&&(wkt.units=wkt.UNIT.name.toLowerCase(),"metre"===wkt.units&&(wkt.units="meter"),wkt.UNIT.convert&&(wkt.to_meter=parseFloat(wkt.UNIT.convert,10))),wkt.GEOGCS&&(wkt.GEOGCS.DATUM?wkt.datumCode=wkt.GEOGCS.DATUM.name.toLowerCase():wkt.datumCode=wkt.GEOGCS.name.toLowerCase(),"d_"===wkt.datumCode.slice(0,2)&&(wkt.datumCode=wkt.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==wkt.datumCode&&"new_zealand_1949"!==wkt.datumCode||(wkt.datumCode="nzgd49"),"wgs_1984"===wkt.datumCode&&("Mercator_Auxiliary_Sphere"===wkt.PROJECTION&&(wkt.sphere=!0),wkt.datumCode="wgs84"),"_ferro"===wkt.datumCode.slice(-6)&&(wkt.datumCode=wkt.datumCode.slice(0,-6)),"_jakarta"===wkt.datumCode.slice(-8)&&(wkt.datumCode=wkt.datumCode.slice(0,-8)),wkt.GEOGCS.DATUM&&wkt.GEOGCS.DATUM.SPHEROID&&(wkt.ellps=wkt.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===wkt.ellps.toLowerCase().slice(0,13)&&(wkt.ellps="intl"),wkt.a=wkt.GEOGCS.DATUM.SPHEROID.a,wkt.rf=parseFloat(wkt.GEOGCS.DATUM.SPHEROID.rf,10))),wkt.b&&!isFinite(wkt.b)&&(wkt.b=wkt.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",d2r],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",d2r],["x0","false_easting",toMeter],["y0","false_northing",toMeter],["long0","central_meridian",d2r],["lat0","latitude_of_origin",d2r],["lat0","standard_parallel_1",d2r],["lat1","standard_parallel_1",d2r],["lat2","standard_parallel_2",d2r],["alpha","azimuth",d2r],["srsCode","name"]].forEach((function(a){return rename(wkt,a)})),wkt.long0||!wkt.longc||"Albers_Conic_Equal_Area"!==wkt.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==wkt.PROJECTION||(wkt.long0=wkt.longc)}module.exports=function(wkt,self){var lisp=JSON.parse((","+wkt).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]')),type=lisp.shift(),name=lisp.shift();lisp.unshift(["name",name]),lisp.unshift(["type",type]),lisp.unshift("output");var obj={};return sExpr(lisp,obj),cleanWKT(obj.output),extend(self,obj.output)}},{"./extend":73}],108:[function(_dereq_,module,exports){var NUM_100K_SETS=6,SET_ORIGIN_COLUMN_LETTERS="AJSAJS",SET_ORIGIN_ROW_LETTERS="AFAFAF",A=65,I=73,O=79,V=86,Z=90;function degToRad(deg){return deg*(Math.PI/180)}function radToDeg(rad){return rad/Math.PI*180}function LLtoUTM(ll){var Lat=ll.lat,Long=ll.lon,a=6378137,eccSquared=.00669438,k0=.9996,LongOrigin,eccPrimeSquared,N,T,C,A,M,LatRad=degToRad(Lat),LongRad=degToRad(Long),LongOriginRad,ZoneNumber;ZoneNumber=Math.floor((Long+180)/6)+1,180===Long&&(ZoneNumber=60),Lat>=56&&Lat<64&&Long>=3&&Long<12&&(ZoneNumber=32),Lat>=72&&Lat<84&&(Long>=0&&Long<9?ZoneNumber=31:Long>=9&&Long<21?ZoneNumber=33:Long>=21&&Long<33?ZoneNumber=35:Long>=33&&Long<42&&(ZoneNumber=37)),LongOriginRad=degToRad(LongOrigin=6*(ZoneNumber-1)-180+3),eccPrimeSquared=.006739496752268451,N=a/Math.sqrt(1-.00669438*Math.sin(LatRad)*Math.sin(LatRad)),T=Math.tan(LatRad)*Math.tan(LatRad),C=eccPrimeSquared*Math.cos(LatRad)*Math.cos(LatRad);var UTMEasting=k0*N*((A=Math.cos(LatRad)*(LongRad-LongOriginRad))+(1-T+C)*A*A*A/6+(5-18*T+T*T+72*C-.39089081163157013)*A*A*A*A*A/120)+5e5,UTMNorthing=k0*((M=a*(.9983242984503243*LatRad-.002514607064228144*Math.sin(2*LatRad)+2639046602129982e-21*Math.sin(4*LatRad)-3.418046101696858e-9*Math.sin(6*LatRad)))+N*Math.tan(LatRad)*(A*A/2+(5-T+9*C+4*C*C)*A*A*A*A/24+(61-58*T+T*T+600*C-2.2240339282485886)*A*A*A*A*A*A/720));return Lat<0&&(UTMNorthing+=1e7),{northing:Math.round(UTMNorthing),easting:Math.round(UTMEasting),zoneNumber:ZoneNumber,zoneLetter:getLetterDesignator(Lat)}}function UTMtoLL(utm){var UTMNorthing=utm.northing,UTMEasting=utm.easting,zoneLetter=utm.zoneLetter,zoneNumber=utm.zoneNumber;if(zoneNumber<0||zoneNumber>60)return null;var k0=.9996,a=6378137,eccSquared=.00669438,eccPrimeSquared,e1=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),N1,T1,C1,R1,D,M,LongOrigin,mu,phi1Rad,x=UTMEasting-5e5,y=UTMNorthing;zoneLetter<"N"&&(y-=1e7),LongOrigin=6*(zoneNumber-1)-180+3,eccPrimeSquared=.006739496752268451,phi1Rad=(mu=(M=y/k0)/6367449.145945056)+(3*e1/2-27*e1*e1*e1/32)*Math.sin(2*mu)+(21*e1*e1/16-55*e1*e1*e1*e1/32)*Math.sin(4*mu)+151*e1*e1*e1/96*Math.sin(6*mu),N1=a/Math.sqrt(1-.00669438*Math.sin(phi1Rad)*Math.sin(phi1Rad)),T1=Math.tan(phi1Rad)*Math.tan(phi1Rad),C1=eccPrimeSquared*Math.cos(phi1Rad)*Math.cos(phi1Rad),R1=.99330562*a/Math.pow(1-.00669438*Math.sin(phi1Rad)*Math.sin(phi1Rad),1.5),D=x/(N1*k0);var lat=phi1Rad-N1*Math.tan(phi1Rad)/R1*(D*D/2-(5+3*T1+10*C1-4*C1*C1-9*eccPrimeSquared)*D*D*D*D/24+(61+90*T1+298*C1+45*T1*T1-1.6983531815716497-3*C1*C1)*D*D*D*D*D*D/720);lat=radToDeg(lat);var lon=(D-(1+2*T1+C1)*D*D*D/6+(5-2*C1+28*T1-3*C1*C1+8*eccPrimeSquared+24*T1*T1)*D*D*D*D*D/120)/Math.cos(phi1Rad),result;if(lon=LongOrigin+radToDeg(lon),utm.accuracy){var topRight=UTMtoLL({northing:utm.northing+utm.accuracy,easting:utm.easting+utm.accuracy,zoneLetter:utm.zoneLetter,zoneNumber:utm.zoneNumber});result={top:topRight.lat,right:topRight.lon,bottom:lat,left:lon}}else result={lat:lat,lon:lon};return result}function getLetterDesignator(lat){var LetterDesignator="Z";return 84>=lat&&lat>=72?LetterDesignator="X":72>lat&&lat>=64?LetterDesignator="W":64>lat&&lat>=56?LetterDesignator="V":56>lat&&lat>=48?LetterDesignator="U":48>lat&&lat>=40?LetterDesignator="T":40>lat&&lat>=32?LetterDesignator="S":32>lat&&lat>=24?LetterDesignator="R":24>lat&&lat>=16?LetterDesignator="Q":16>lat&&lat>=8?LetterDesignator="P":8>lat&&lat>=0?LetterDesignator="N":0>lat&&lat>=-8?LetterDesignator="M":-8>lat&&lat>=-16?LetterDesignator="L":-16>lat&&lat>=-24?LetterDesignator="K":-24>lat&&lat>=-32?LetterDesignator="J":-32>lat&&lat>=-40?LetterDesignator="H":-40>lat&&lat>=-48?LetterDesignator="G":-48>lat&&lat>=-56?LetterDesignator="F":-56>lat&&lat>=-64?LetterDesignator="E":-64>lat&&lat>=-72?LetterDesignator="D":-72>lat&&lat>=-80&&(LetterDesignator="C"),LetterDesignator}function encode(utm,accuracy){var seasting=""+utm.easting,snorthing=""+utm.northing;return utm.zoneNumber+utm.zoneLetter+get100kID(utm.easting,utm.northing,utm.zoneNumber)+seasting.substr(seasting.length-5,accuracy)+snorthing.substr(snorthing.length-5,accuracy)}function get100kID(easting,northing,zoneNumber){var setParm=get100kSetForZone(zoneNumber),setColumn,setRow;return getLetter100kID(Math.floor(easting/1e5),Math.floor(northing/1e5)%20,setParm)}function get100kSetForZone(i){var setParm=i%NUM_100K_SETS;return 0===setParm&&(setParm=NUM_100K_SETS),setParm}function getLetter100kID(column,row,parm){var index=parm-1,colOrigin=SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index),rowOrigin=SET_ORIGIN_ROW_LETTERS.charCodeAt(index),colInt=colOrigin+column-1,rowInt=rowOrigin+row,rollover=!1,twoLetter;return colInt>Z&&(colInt=colInt-Z+A-1,rollover=!0),(colInt===I||colOrigin<I&&colInt>I||(colInt>I||colOrigin<I)&&rollover)&&colInt++,(colInt===O||colOrigin<O&&colInt>O||(colInt>O||colOrigin<O)&&rollover)&&++colInt===I&&colInt++,colInt>Z&&(colInt=colInt-Z+A-1),rowInt>V?(rowInt=rowInt-V+A-1,rollover=!0):rollover=!1,(rowInt===I||rowOrigin<I&&rowInt>I||(rowInt>I||rowOrigin<I)&&rollover)&&rowInt++,(rowInt===O||rowOrigin<O&&rowInt>O||(rowInt>O||rowOrigin<O)&&rollover)&&++rowInt===I&&rowInt++,rowInt>V&&(rowInt=rowInt-V+A-1),String.fromCharCode(colInt)+String.fromCharCode(rowInt)}function decode(mgrsString){if(mgrsString&&0===mgrsString.length)throw"MGRSPoint coverting from nothing";for(var length=mgrsString.length,hunK=null,sb="",testChar,i=0;!/[A-Z]/.test(testChar=mgrsString.charAt(i));){if(i>=2)throw"MGRSPoint bad conversion from: "+mgrsString;sb+=testChar,i++}var zoneNumber=parseInt(sb,10);if(0===i||i+3>length)throw"MGRSPoint bad conversion from: "+mgrsString;var zoneLetter=mgrsString.charAt(i++);if(zoneLetter<="A"||"B"===zoneLetter||"Y"===zoneLetter||zoneLetter>="Z"||"I"===zoneLetter||"O"===zoneLetter)throw"MGRSPoint zone letter "+zoneLetter+" not handled: "+mgrsString;hunK=mgrsString.substring(i,i+=2);for(var set=get100kSetForZone(zoneNumber),east100k=getEastingFromChar(hunK.charAt(0),set),north100k=getNorthingFromChar(hunK.charAt(1),set);north100k<getMinNorthing(zoneLetter);)north100k+=2e6;var remainder=length-i;if(remainder%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+mgrsString;var sep=remainder/2,sepEasting=0,sepNorthing=0,accuracyBonus,sepEastingString,sepNorthingString,easting,northing;return sep>0&&(accuracyBonus=1e5/Math.pow(10,sep),sepEastingString=mgrsString.substring(i,i+sep),sepEasting=parseFloat(sepEastingString)*accuracyBonus,sepNorthingString=mgrsString.substring(i+sep),sepNorthing=parseFloat(sepNorthingString)*accuracyBonus),{easting:easting=sepEasting+east100k,northing:northing=sepNorthing+north100k,zoneLetter:zoneLetter,zoneNumber:zoneNumber,accuracy:accuracyBonus}}function getEastingFromChar(e,set){for(var curCol=SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set-1),eastingValue=1e5,rewindMarker=!1;curCol!==e.charCodeAt(0);){if(++curCol===I&&curCol++,curCol===O&&curCol++,curCol>Z){if(rewindMarker)throw"Bad character: "+e;curCol=A,rewindMarker=!0}eastingValue+=1e5}return eastingValue}function getNorthingFromChar(n,set){if(n>"V")throw"MGRSPoint given invalid Northing "+n;for(var curRow=SET_ORIGIN_ROW_LETTERS.charCodeAt(set-1),northingValue=0,rewindMarker=!1;curRow!==n.charCodeAt(0);){if(++curRow===I&&curRow++,curRow===O&&curRow++,curRow>V){if(rewindMarker)throw"Bad character: "+n;curRow=A,rewindMarker=!0}northingValue+=1e5}return northingValue}function getMinNorthing(zoneLetter){var northing;switch(zoneLetter){case"C":northing=11e5;break;case"D":northing=2e6;break;case"E":northing=28e5;break;case"F":northing=37e5;break;case"G":northing=46e5;break;case"H":northing=55e5;break;case"J":northing=64e5;break;case"K":northing=73e5;break;case"L":northing=82e5;break;case"M":northing=91e5;break;case"N":northing=0;break;case"P":northing=8e5;break;case"Q":northing=17e5;break;case"R":northing=26e5;break;case"S":northing=35e5;break;case"T":northing=44e5;break;case"U":northing=53e5;break;case"V":northing=62e5;break;case"W":northing=7e6;break;case"X":northing=79e5;break;default:northing=-1}if(northing>=0)return northing;throw"Invalid zone letter: "+zoneLetter}exports.forward=function(ll,accuracy){return accuracy=accuracy||5,encode(LLtoUTM({lat:ll[1],lon:ll[0]}),accuracy)},exports.inverse=function(mgrs){var bbox=UTMtoLL(decode(mgrs.toUpperCase()));return[bbox.left,bbox.bottom,bbox.right,bbox.top]},exports.toPoint=function(mgrsStr){var llbbox=exports.inverse(mgrsStr);return[(llbbox[2]+llbbox[0])/2,(llbbox[3]+llbbox[1])/2]}},{}]},{},[2])(2)}));